<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>VectSharp: VectSharp.PDF/PDFContext.cs Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="Doxy.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="icon.svg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">VectSharp
   &#160;<span id="projectnumber">1.7.0</span>
   </div>
   <div id="projectbrief">A light library for C# vector graphics</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_p_d_f_context_8cs_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">PDFContext.cs</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">    VectSharp - A light library for C# vector graphics.</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">    Copyright (C) 2020  Giorgio Bianchini</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">    This program is free software: you can redistribute it and/or modify</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">    it under the terms of the GNU General Public License as published by</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">    the Free Software Foundation, version 3.</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">    This program is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">    GNU General Public License for more details.</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">    You should have received a copy of the GNU General Public License</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">    along with this program.  If not, see &lt;https://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="keyword">using</span> System;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="keyword">using</span> System.Collections;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="keyword">using</span> System.Collections.Generic;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="keyword">using</span> System.IO;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="keyword">using</span> System.IO.Compression;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="keyword">using</span> System.Linq;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="keyword">using</span> System.Runtime.InteropServices;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="keyword">using</span> System.Text;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno"><a class="line" href="namespace_vect_sharp_1_1_p_d_f.html">   27</a></span>&#160;<span class="keyword">namespace </span><a class="code" href="namespace_vect_sharp_1_1_p_d_f.html">VectSharp.PDF</a></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;{</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keyword">internal</span> <span class="keyword">enum</span> SegmentType</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    {</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        <a class="code" href="namespace_vect_sharp.html#ad82c158fff255cb1cbe8d51de61cb4e4a6bc362dbf494c61ea117fe3c71ca48a5">Move</a>, <a class="code" href="namespace_vect_sharp.html#ad82c158fff255cb1cbe8d51de61cb4e4a4803e6b9e63dabf04de980788d6a13c4">Line</a>, <a class="code" href="namespace_vect_sharp.html#ad82c158fff255cb1cbe8d51de61cb4e4aced824f3a4e9dd5feb68da4cb78a3430">CubicBezier</a>, <a class="code" href="namespace_vect_sharp.html#ad82c158fff255cb1cbe8d51de61cb4e4a2b73f91683611c489560a1d163e37902">Arc</a>, <a class="code" href="namespace_vect_sharp.html#ad82c158fff255cb1cbe8d51de61cb4e4ad3d2e617335f08df83599665eef8a418">Close</a></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    }</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="keyword">internal</span> <span class="keyword">abstract</span> <span class="keyword">class </span>Segment</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        <span class="keyword">public</span> <span class="keyword">abstract</span> SegmentType Type { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        <span class="keyword">public</span> <a class="code" href="struct_vect_sharp_1_1_point.html">Point</a>[] Points { <span class="keyword">get</span>; <span class="keyword">protected</span> <span class="keyword">set</span>; }</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        <span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="struct_vect_sharp_1_1_point.html">Point</a> <a class="code" href="struct_vect_sharp_1_1_point.html">Point</a></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;            <span class="keyword">get</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;            {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;                <span class="keywordflow">return</span> Points[Points.Length - 1];</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;            }</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        }</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        <span class="keyword">public</span> <span class="keyword">abstract</span> Segment Clone();</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    }</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keyword">internal</span> <span class="keyword">class </span>MoveSegment : Segment</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <span class="keyword">public</span> <span class="keyword">override</span> SegmentType Type =&gt; SegmentType.Move;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <span class="keyword">public</span> MoveSegment(<a class="code" href="struct_vect_sharp_1_1_point.html">Point</a> p)</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            this.Points = <span class="keyword">new</span> <a class="code" href="struct_vect_sharp_1_1_point.html">Point</a>[] { p };</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        }</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <span class="keyword">public</span> MoveSegment(<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y)</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;            this.Points = <span class="keyword">new</span> <a class="code" href="struct_vect_sharp_1_1_point.html">Point</a>[] { <span class="keyword">new</span> <a class="code" href="struct_vect_sharp_1_1_point.html">Point</a>(x, y) };</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        }</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <span class="keyword">public</span> <span class="keyword">override</span> Segment Clone()</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">new</span> MoveSegment(this.<a class="code" href="struct_vect_sharp_1_1_point.html">Point</a>);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        }</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    }</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keyword">internal</span> <span class="keyword">class </span>LineSegment : Segment</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <span class="keyword">public</span> <span class="keyword">override</span> SegmentType Type =&gt; SegmentType.Line;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <span class="keyword">public</span> LineSegment(<a class="code" href="struct_vect_sharp_1_1_point.html">Point</a> p)</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            this.Points = <span class="keyword">new</span> <a class="code" href="struct_vect_sharp_1_1_point.html">Point</a>[] { p };</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        }</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <span class="keyword">public</span> LineSegment(<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y)</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            this.Points = <span class="keyword">new</span> <a class="code" href="struct_vect_sharp_1_1_point.html">Point</a>[] { <span class="keyword">new</span> <a class="code" href="struct_vect_sharp_1_1_point.html">Point</a>(x, y) };</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        }</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="keyword">public</span> <span class="keyword">override</span> Segment Clone()</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">new</span> LineSegment(this.<a class="code" href="struct_vect_sharp_1_1_point.html">Point</a>);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        }</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keyword">internal</span> <span class="keyword">class </span>CloseSegment : Segment</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keyword">public</span> <span class="keyword">override</span> SegmentType Type =&gt; SegmentType.Close;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="keyword">public</span> CloseSegment() { }</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="keyword">public</span> <span class="keyword">override</span> Segment Clone()</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">new</span> CloseSegment();</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    }</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keyword">internal</span> <span class="keyword">class </span>CubicBezierSegment : Segment</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="keyword">public</span> <span class="keyword">override</span> SegmentType Type =&gt; SegmentType.CubicBezier;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keyword">public</span> CubicBezierSegment(<span class="keywordtype">double</span> x1, <span class="keywordtype">double</span> y1, <span class="keywordtype">double</span> x2, <span class="keywordtype">double</span> y2, <span class="keywordtype">double</span> x3, <span class="keywordtype">double</span> y3)</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            Points = <span class="keyword">new</span> <a class="code" href="struct_vect_sharp_1_1_point.html">Point</a>[] { <span class="keyword">new</span> <a class="code" href="struct_vect_sharp_1_1_point.html">Point</a>(x1, y1), <span class="keyword">new</span> <a class="code" href="struct_vect_sharp_1_1_point.html">Point</a>(x2, y2), <span class="keyword">new</span> <a class="code" href="struct_vect_sharp_1_1_point.html">Point</a>(x3, y3) };</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        }</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="keyword">public</span> CubicBezierSegment(<a class="code" href="struct_vect_sharp_1_1_point.html">Point</a> p1, <a class="code" href="struct_vect_sharp_1_1_point.html">Point</a> p2, <a class="code" href="struct_vect_sharp_1_1_point.html">Point</a> p3)</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            Points = <span class="keyword">new</span> <a class="code" href="struct_vect_sharp_1_1_point.html">Point</a>[] { p1, p2, p3 };</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        }</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="keyword">public</span> <span class="keyword">override</span> Segment Clone()</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">new</span> CubicBezierSegment(Points[0], Points[1], Points[2]);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keyword">internal</span> <span class="keyword">interface </span>IFigure</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <a class="code" href="struct_vect_sharp_1_1_colour.html">Colour</a>? Fill { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <a class="code" href="struct_vect_sharp_1_1_colour.html">Colour</a>? Stroke { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <span class="keywordtype">double</span> LineWidth { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <a class="code" href="namespace_vect_sharp.html#a6bde58d6aab37ea51e32240503678209">LineCaps</a> LineCap { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <a class="code" href="namespace_vect_sharp.html#a58a4a36ea254b3d255755654fd9e61f6">LineJoins</a> LineJoin { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <a class="code" href="struct_vect_sharp_1_1_line_dash.html">LineDash</a> <a class="code" href="struct_vect_sharp_1_1_line_dash.html">LineDash</a> { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="keywordtype">bool</span> IsClipping { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="keywordtype">string</span> Tag { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    }</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keyword">internal</span> <span class="keyword">class </span>TransformFigure : IFigure</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="keyword">public</span> <span class="keyword">enum</span> TransformTypes</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            Transform, Save, Restore</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        }</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <span class="keyword">public</span> TransformTypes TransformType { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="keyword">public</span> <a class="code" href="struct_vect_sharp_1_1_colour.html">Colour</a>? Fill { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="keyword">public</span> <a class="code" href="struct_vect_sharp_1_1_colour.html">Colour</a>? Stroke { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">bool</span> IsClipping { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">double</span> LineWidth { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">double</span>[,] TransformationMatrix { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="keyword">public</span> <a class="code" href="namespace_vect_sharp.html#a6bde58d6aab37ea51e32240503678209">LineCaps</a> LineCap { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="keyword">public</span> <a class="code" href="namespace_vect_sharp.html#a58a4a36ea254b3d255755654fd9e61f6">LineJoins</a> LineJoin { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="keyword">public</span> <a class="code" href="struct_vect_sharp_1_1_line_dash.html">LineDash</a> <a class="code" href="struct_vect_sharp_1_1_line_dash.html">LineDash</a> { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">string</span> Tag { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="keyword">public</span> TransformFigure(TransformTypes type, <span class="keywordtype">double</span>[,] transformationMatrix, <span class="keywordtype">string</span> tag)</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            this.TransformType = type;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            this.TransformationMatrix = transformationMatrix;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            this.Tag = tag;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        }</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    }</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keyword">internal</span> <span class="keyword">class </span>RasterImageFigure : IFigure</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="keyword">public</span> <a class="code" href="struct_vect_sharp_1_1_colour.html">Colour</a>? Fill { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="keyword">public</span> <a class="code" href="struct_vect_sharp_1_1_colour.html">Colour</a>? Stroke { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">bool</span> IsClipping { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">double</span> LineWidth { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">double</span>[,] TransformationMatrix { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="keyword">public</span> <a class="code" href="namespace_vect_sharp.html#a6bde58d6aab37ea51e32240503678209">LineCaps</a> LineCap { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="keyword">public</span> <a class="code" href="namespace_vect_sharp.html#a58a4a36ea254b3d255755654fd9e61f6">LineJoins</a> LineJoin { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="keyword">public</span> <a class="code" href="struct_vect_sharp_1_1_line_dash.html">LineDash</a> <a class="code" href="struct_vect_sharp_1_1_line_dash.html">LineDash</a> { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="keyword">public</span> <a class="code" href="class_vect_sharp_1_1_raster_image.html">RasterImage</a> Image { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">string</span> Tag { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="keyword">public</span> RasterImageFigure(<a class="code" href="class_vect_sharp_1_1_raster_image.html">RasterImage</a> image, <span class="keywordtype">string</span> tag)</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        {</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            this.Image = image;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            this.Tag = tag;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keyword">internal</span> <span class="keyword">class </span>PathFigure : IFigure</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <span class="keyword">public</span> <a class="code" href="struct_vect_sharp_1_1_colour.html">Colour</a>? Fill { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <span class="keyword">public</span> <a class="code" href="struct_vect_sharp_1_1_colour.html">Colour</a>? Stroke { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">bool</span> IsClipping { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">double</span> LineWidth { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <span class="keyword">public</span> <a class="code" href="namespace_vect_sharp.html#a6bde58d6aab37ea51e32240503678209">LineCaps</a> LineCap { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="keyword">public</span> <a class="code" href="namespace_vect_sharp.html#a58a4a36ea254b3d255755654fd9e61f6">LineJoins</a> LineJoin { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <span class="keyword">public</span> <a class="code" href="struct_vect_sharp_1_1_line_dash.html">LineDash</a> <a class="code" href="struct_vect_sharp_1_1_line_dash.html">LineDash</a> { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <span class="keyword">public</span> Segment[] Segments { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">string</span> Tag { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <span class="keyword">public</span> PathFigure(IEnumerable&lt;Segment&gt; segments, <a class="code" href="struct_vect_sharp_1_1_colour.html">Colour</a>? fill, <a class="code" href="struct_vect_sharp_1_1_colour.html">Colour</a>? stroke, <span class="keywordtype">double</span> lineWidth, <a class="code" href="namespace_vect_sharp.html#a6bde58d6aab37ea51e32240503678209">LineCaps</a> lineCap, <a class="code" href="namespace_vect_sharp.html#a58a4a36ea254b3d255755654fd9e61f6">LineJoins</a> lineJoin, <a class="code" href="struct_vect_sharp_1_1_line_dash.html">LineDash</a> lineDash, <span class="keywordtype">bool</span> isClipping, <span class="keywordtype">string</span> tag)</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            List&lt;Segment&gt; segs = <span class="keyword">new</span> List&lt;Segment&gt;();</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            <span class="keywordflow">foreach</span> (Segment s <span class="keywordflow">in</span> segments)</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            {</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                segs.Add(s.Clone());</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            }</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            this.Segments = segs.ToArray();</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            Fill = fill;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            Stroke = stroke;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            LineWidth = lineWidth;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            LineCap = lineCap;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            LineJoin = lineJoin;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            <a class="code" href="struct_vect_sharp_1_1_line_dash.html">LineDash</a> = lineDash;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            IsClipping = isClipping;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            this.Tag = tag;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        }</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    }</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="keyword">internal</span> <span class="keyword">class </span>TextFigure : IFigure</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <span class="keyword">public</span> <a class="code" href="struct_vect_sharp_1_1_colour.html">Colour</a>? Fill { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <span class="keyword">public</span> <a class="code" href="struct_vect_sharp_1_1_colour.html">Colour</a>? Stroke { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">double</span> LineWidth { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">bool</span> IsClipping { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <span class="keyword">public</span> <a class="code" href="namespace_vect_sharp.html#a6bde58d6aab37ea51e32240503678209">LineCaps</a> LineCap { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <span class="keyword">public</span> <a class="code" href="namespace_vect_sharp.html#a58a4a36ea254b3d255755654fd9e61f6">LineJoins</a> LineJoin { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <span class="keyword">public</span> <a class="code" href="struct_vect_sharp_1_1_line_dash.html">LineDash</a> <a class="code" href="struct_vect_sharp_1_1_line_dash.html">LineDash</a> { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">string</span> Text { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="keyword">public</span> <a class="code" href="class_vect_sharp_1_1_font.html">Font</a> <a class="code" href="class_vect_sharp_1_1_font.html">Font</a> { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <span class="keyword">public</span> <a class="code" href="struct_vect_sharp_1_1_point.html">Point</a> Position { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <span class="keyword">public</span> <a class="code" href="namespace_vect_sharp.html#acfad2994b272989b9cb471230d95334f">TextBaselines</a> TextBaseline { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">string</span> Tag { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <span class="keyword">public</span> TextFigure(<span class="keywordtype">string</span> text, <a class="code" href="class_vect_sharp_1_1_font.html">Font</a> font, <a class="code" href="struct_vect_sharp_1_1_point.html">Point</a> position, <a class="code" href="namespace_vect_sharp.html#acfad2994b272989b9cb471230d95334f">TextBaselines</a> textBaseline, <a class="code" href="struct_vect_sharp_1_1_colour.html">Colour</a>? fill, <a class="code" href="struct_vect_sharp_1_1_colour.html">Colour</a>? stroke, <span class="keywordtype">double</span> lineWidth, <a class="code" href="namespace_vect_sharp.html#a6bde58d6aab37ea51e32240503678209">LineCaps</a> lineCap, <a class="code" href="namespace_vect_sharp.html#a58a4a36ea254b3d255755654fd9e61f6">LineJoins</a> lineJoin, <a class="code" href="struct_vect_sharp_1_1_line_dash.html">LineDash</a> lineDash, <span class="keywordtype">string</span> tag)</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        {</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            Text = text;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            <a class="code" href="class_vect_sharp_1_1_font.html">Font</a> = font;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            Position = position;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            TextBaseline = textBaseline;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            Fill = fill;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            Stroke = stroke;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            LineWidth = lineWidth;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            LineCap = lineCap;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            LineJoin = lineJoin;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            <a class="code" href="struct_vect_sharp_1_1_line_dash.html">LineDash</a> = lineDash;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            this.Tag = tag;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        }</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keyword">internal</span> <span class="keyword">class </span>PDFFontDescriptor</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="keyword">private</span> <span class="keyword">static</span> readonly Random TagGenerator = <span class="keyword">new</span> Random();</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="keyword">private</span> <span class="keyword">static</span> readonly List&lt;string&gt; TagCache = <span class="keyword">new</span> List&lt;string&gt;();</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">string</span> FontName { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">string</span> <a class="code" href="class_vect_sharp_1_1_font_family.html">FontFamily</a> { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <span class="keyword">public</span> uint Flags { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">double</span>[] FontBBox { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">int</span> ItalicAngle =&gt; 0;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">double</span> Ascent { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">double</span> Descent { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">double</span> CapHeight { <span class="keyword">get</span> { <span class="keywordflow">return</span> Ascent; } }</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">int</span> StemV =&gt; 80;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">int</span> StemH =&gt; 80;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="keyword">public</span> PDFFontDescriptor(<a class="code" href="class_vect_sharp_1_1_true_type_file.html">TrueTypeFile</a> ttf, <span class="keywordtype">bool</span> isSubset, <span class="keywordtype">bool</span> isSymbolic)</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            this.Ascent = ttf.<a class="code" href="class_vect_sharp_1_1_true_type_file.html#a1e1f305a731f09899d434eab608be504">Get1000EmAscent</a>();</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            this.Descent = ttf.<a class="code" href="class_vect_sharp_1_1_true_type_file.html#acd6fac0c1556a58be91ddfcda2f40963">Get1000EmDescent</a>();</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            this.FontBBox = <span class="keyword">new</span> <span class="keywordtype">double</span>[] { ttf.<a class="code" href="class_vect_sharp_1_1_true_type_file.html#a8eacb1aad853f9938824a90c43dd4171">Get1000EmXMin</a>(), ttf.<a class="code" href="class_vect_sharp_1_1_true_type_file.html#acd1b6e15206231fc0c8a0c8a4db3d7b0">Get1000EmYMin</a>(), ttf.<a class="code" href="class_vect_sharp_1_1_true_type_file.html#a37a6a96e07782c4f6264a5ee11408618">Get1000EmXMax</a>(), ttf.<a class="code" href="class_vect_sharp_1_1_true_type_file.html#a007e5a47fcd0eeac25a2d40e1e87a6a7">Get1000EmYMax</a>() };</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            <span class="keywordtype">bool</span> fixedPitch = ttf.<a class="code" href="class_vect_sharp_1_1_true_type_file.html#a5cbc0138ead9fd519e09e8f1988c7117">IsFixedPitch</a>();</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            <span class="keywordtype">bool</span> serif = ttf.<a class="code" href="class_vect_sharp_1_1_true_type_file.html#aee6f8fdf0984954c8ad83a2d9dbd91cc">IsSerif</a>();</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            <span class="keywordtype">bool</span> script = ttf.<a class="code" href="class_vect_sharp_1_1_true_type_file.html#a7fde1c54dbe0648291951d248aebee18">IsScript</a>();</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            <span class="keywordtype">bool</span> italic = ttf.<a class="code" href="class_vect_sharp_1_1_true_type_file.html#a7e8376d45118eef1099fe0ad33d0e21b">IsBold</a>();</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            <span class="keywordtype">bool</span> allCap = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            <span class="keywordtype">bool</span> smallCap = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            <span class="keywordtype">bool</span> forceBold = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            this.Flags = (fixedPitch ? 1U : 0) | (serif ? 1U &lt;&lt; 1 : 0) | (isSymbolic ? 1U &lt;&lt; 2 : 0) | (script ? 1U &lt;&lt; 3 : 0) | (!isSymbolic ? 1U &lt;&lt; 5 : 0) | (italic ? 1U &lt;&lt; 6 : 0) | (allCap ? 1U &lt;&lt; 16 : 0) | (smallCap ? 1U &lt;&lt; 17 : 0) | (forceBold ? 1U &lt;&lt; 18 : 0);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            this.FontName = ttf.<a class="code" href="class_vect_sharp_1_1_true_type_file.html#a282ffb486dc20d30f55f64941ab32720">GetFontName</a>();</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            this.<a class="code" href="class_vect_sharp_1_1_font_family.html">FontFamily</a> = ttf.<a class="code" href="class_vect_sharp_1_1_true_type_file.html#abd9c8b6a0adca6684e4bc629a447d849">GetFontFamilyName</a>();</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            <span class="keywordflow">if</span> (<span class="keywordtype">string</span>.IsNullOrEmpty(this.<a class="code" href="class_vect_sharp_1_1_font_family.html">FontFamily</a>))</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            {</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                this.<a class="code" href="class_vect_sharp_1_1_font_family.html">FontFamily</a> = FontName;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            }</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            <span class="keywordflow">if</span> (isSubset)</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            {</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                <span class="keywordtype">string</span> randString = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                <span class="keywordflow">while</span> (randString.Length == 0 || TagCache.Contains(randString))</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                    randString = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 6; i++)</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                    {</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                        randString += (char)TagGenerator.Next(65, 91);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                    }</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                }</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160; </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                this.FontName = randString + <span class="stringliteral">&quot;+&quot;</span> + this.FontName;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            }</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        }</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    }</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160; </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keyword">internal</span> <span class="keyword">class </span>PDFContext : <a class="code" href="interface_vect_sharp_1_1_i_graphics_context.html">IGraphicsContext</a></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    {</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">string</span> Tag { <span class="keyword">get</span>; <span class="keyword">set</span>; }</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">double</span> Width { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">double</span> Height { <span class="keyword">get</span>; }</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160; </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <span class="keyword">private</span> List&lt;Segment&gt; _currentFigure;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="keyword">internal</span> List&lt;IFigure&gt; _figures;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <span class="keyword">private</span> <a class="code" href="struct_vect_sharp_1_1_colour.html">Colour</a> _strokeStyle;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <span class="keyword">private</span> <a class="code" href="struct_vect_sharp_1_1_colour.html">Colour</a> _fillStyle;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <span class="keyword">private</span> <a class="code" href="struct_vect_sharp_1_1_line_dash.html">LineDash</a> _lineDash;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <span class="keyword">private</span> readonly <span class="keywordtype">bool</span> _textToPaths;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        <span class="keyword">public</span> PDFContext(<span class="keywordtype">double</span> width, <span class="keywordtype">double</span> height, <a class="code" href="struct_vect_sharp_1_1_colour.html">Colour</a> background, <span class="keywordtype">bool</span> textToPaths)</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        {</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            this.Width = width;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            this.Height = height;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160; </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            _currentFigure = <span class="keyword">new</span> List&lt;Segment&gt;();</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            _figures = <span class="keyword">new</span> List&lt;IFigure&gt;();</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;            _strokeStyle = <a class="code" href="struct_vect_sharp_1_1_colour.html">Colour</a>.<a class="code" href="struct_vect_sharp_1_1_colour.html#a80787f39829f01b38291bb429214d6ae">FromRgb</a>(0, 0, 0);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            _fillStyle = <a class="code" href="struct_vect_sharp_1_1_colour.html">Colour</a>.<a class="code" href="struct_vect_sharp_1_1_colour.html#a80787f39829f01b38291bb429214d6ae">FromRgb</a>(0, 0, 0);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            LineWidth = 1;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            LineCap = <a class="code" href="namespace_vect_sharp.html#a6bde58d6aab37ea51e32240503678209">LineCaps</a>.Butt;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            LineJoin = <a class="code" href="namespace_vect_sharp.html#a58a4a36ea254b3d255755654fd9e61f6">LineJoins</a>.Miter;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            _lineDash = <span class="keyword">new</span> <a class="code" href="struct_vect_sharp_1_1_line_dash.html">LineDash</a>(0, 0, 0);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            _textToPaths = textToPaths;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160; </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            <a class="code" href="class_vect_sharp_1_1_font.html">Font</a> = <span class="keyword">new</span> <a class="code" href="class_vect_sharp_1_1_font.html">Font</a>(<span class="keyword">new</span> <a class="code" href="class_vect_sharp_1_1_font_family.html">FontFamily</a>(<a class="code" href="class_vect_sharp_1_1_font_family.html">FontFamily</a>.<a class="code" href="class_vect_sharp_1_1_font_family.html#a6cdec4eb0a660064bc416e81f69d3780">StandardFontFamilies</a>.Helvetica), 12);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160; </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            TextBaseline = <a class="code" href="namespace_vect_sharp.html#acfad2994b272989b9cb471230d95334f">TextBaselines</a>.Top;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            this.Translate(0, height);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;            this.Scale(1, -1);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;            this.Rectangle(0, 0, width, height);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;            this.SetFillStyle(background);</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            this.Fill();</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160; </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            this.SetFillStyle(<a class="code" href="struct_vect_sharp_1_1_colour.html">Colour</a>.<a class="code" href="struct_vect_sharp_1_1_colour.html#a80787f39829f01b38291bb429214d6ae">FromRgb</a>(0, 0, 0));</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        }</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> MoveTo(<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y)</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        {</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;            _currentFigure.Add(<span class="keyword">new</span> MoveSegment(x, y));</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        }</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> LineTo(<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y)</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        {</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            _currentFigure.Add(<span class="keyword">new</span> LineSegment(x, y));</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        }</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160; </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="namespace_vect_sharp.html#ad82c158fff255cb1cbe8d51de61cb4e4ad3d2e617335f08df83599665eef8a418">Close</a>()</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        {</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            _currentFigure.Add(<span class="keyword">new</span> CloseSegment());</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        }</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160; </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> Rectangle(<span class="keywordtype">double</span> x0, <span class="keywordtype">double</span> y0, <span class="keywordtype">double</span> width, <span class="keywordtype">double</span> height)</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        {</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            MoveTo(x0, y0);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            LineTo(x0 + width, y0);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            LineTo(x0 + width, y0 + height);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            LineTo(x0, y0 + height);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            <a class="code" href="namespace_vect_sharp.html#ad82c158fff255cb1cbe8d51de61cb4e4ad3d2e617335f08df83599665eef8a418">Close</a>();</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        }</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> SetStrokeStyle((<span class="keywordtype">int</span> r, <span class="keywordtype">int</span> g, <span class="keywordtype">int</span> b, <span class="keywordtype">double</span> a) style)</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        {</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;            _strokeStyle = <a class="code" href="struct_vect_sharp_1_1_colour.html">Colour</a>.<a class="code" href="struct_vect_sharp_1_1_colour.html#ae8dc3a457be395b0350db3508424a324">FromRgba</a>(style.r, style.g, style.b, style.a);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        }</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> SetStrokeStyle(<a class="code" href="struct_vect_sharp_1_1_colour.html">Colour</a> style)</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        {</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;            _strokeStyle = style;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        }</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> SetFillStyle((<span class="keywordtype">int</span> r, <span class="keywordtype">int</span> g, <span class="keywordtype">int</span> b, <span class="keywordtype">double</span> a) style)</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        {</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            _fillStyle = <a class="code" href="struct_vect_sharp_1_1_colour.html">Colour</a>.<a class="code" href="struct_vect_sharp_1_1_colour.html#ae8dc3a457be395b0350db3508424a324">FromRgba</a>(style.r, style.g, style.b, style.a);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        }</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160; </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> SetFillStyle(<a class="code" href="struct_vect_sharp_1_1_colour.html">Colour</a> style)</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        {</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;            _fillStyle = style;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        }</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160; </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="keyword">public</span> <a class="code" href="struct_vect_sharp_1_1_colour.html">Colour</a> FillStyle { <span class="keyword">get</span> { <span class="keywordflow">return</span> _fillStyle; } }</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <span class="keyword">public</span> <a class="code" href="struct_vect_sharp_1_1_colour.html">Colour</a> StrokeStyle { <span class="keyword">get</span> { <span class="keywordflow">return</span> _strokeStyle; } }</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160; </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">double</span> LineWidth { <span class="keyword">get</span>; <span class="keyword">set</span>; }</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160; </div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        <span class="keyword">public</span> <a class="code" href="namespace_vect_sharp.html#a6bde58d6aab37ea51e32240503678209">LineCaps</a> LineCap { <span class="keyword">get</span>; <span class="keyword">set</span>; }</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        <span class="keyword">public</span> <a class="code" href="namespace_vect_sharp.html#a58a4a36ea254b3d255755654fd9e61f6">LineJoins</a> LineJoin { <span class="keyword">get</span>; <span class="keyword">set</span>; }</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160; </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> Fill()</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            _figures.Add(<span class="keyword">new</span> PathFigure(_currentFigure, _fillStyle, <span class="keyword">null</span>, 0, <a class="code" href="namespace_vect_sharp.html#a6bde58d6aab37ea51e32240503678209">LineCaps</a>.Butt, <a class="code" href="namespace_vect_sharp.html#a58a4a36ea254b3d255755654fd9e61f6">LineJoins</a>.Bevel, <span class="keyword">new</span> <a class="code" href="struct_vect_sharp_1_1_line_dash.html">LineDash</a>(0, 0, 0), <span class="keyword">false</span>, this.Tag));</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            _currentFigure = <span class="keyword">new</span> List&lt;Segment&gt;();</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        }</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> Stroke()</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        {</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            _figures.Add(<span class="keyword">new</span> PathFigure(_currentFigure, <span class="keyword">null</span>, _strokeStyle, LineWidth, LineCap, LineJoin, _lineDash, <span class="keyword">false</span>, this.Tag));</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            _currentFigure = <span class="keyword">new</span> List&lt;Segment&gt;();</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        }</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160; </div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> SetClippingPath()</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        {</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            _figures.Add(<span class="keyword">new</span> PathFigure(_currentFigure, <span class="keyword">null</span>, <span class="keyword">null</span>, 0, <a class="code" href="namespace_vect_sharp.html#a6bde58d6aab37ea51e32240503678209">LineCaps</a>.Butt, <a class="code" href="namespace_vect_sharp.html#a58a4a36ea254b3d255755654fd9e61f6">LineJoins</a>.Bevel, <span class="keyword">new</span> <a class="code" href="struct_vect_sharp_1_1_line_dash.html">LineDash</a>(0, 0, 0), <span class="keyword">true</span>, this.Tag));</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            _currentFigure = <span class="keyword">new</span> List&lt;Segment&gt;();</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        }</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160; </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> CubicBezierTo(<span class="keywordtype">double</span> x1, <span class="keywordtype">double</span> y1, <span class="keywordtype">double</span> x2, <span class="keywordtype">double</span> y2, <span class="keywordtype">double</span> x3, <span class="keywordtype">double</span> y3)</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        {</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;            _currentFigure.Add(<span class="keyword">new</span> CubicBezierSegment(x1, y1, x2, y2, x3, y3));</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        }</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160; </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> SetLineDash(<a class="code" href="struct_vect_sharp_1_1_line_dash.html">LineDash</a> dash)</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        {</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;            _lineDash = dash;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        }</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160; </div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <span class="keyword">public</span> <a class="code" href="class_vect_sharp_1_1_font.html">Font</a> <a class="code" href="class_vect_sharp_1_1_font.html">Font</a> { <span class="keyword">get</span>; <span class="keyword">set</span>; }</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160; </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> PathText(<span class="keywordtype">string</span> text, <span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y)</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        {</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;            <a class="code" href="class_vect_sharp_1_1_graphics_path.html">GraphicsPath</a> textPath = <span class="keyword">new</span> <a class="code" href="class_vect_sharp_1_1_graphics_path.html">GraphicsPath</a>().<a class="code" href="class_vect_sharp_1_1_graphics_path.html#acb6657677bfcf1f40485fa17281acee2">AddText</a>(x, y, text, <a class="code" href="class_vect_sharp_1_1_font.html">Font</a>, TextBaseline);</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160; </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; textPath.<a class="code" href="class_vect_sharp_1_1_graphics_path.html#aabd97b02c49fc2de576d76710af8fedc">Segments</a>.Count; j++)</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            {</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                <span class="keywordflow">switch</span> (textPath.<a class="code" href="class_vect_sharp_1_1_graphics_path.html#aabd97b02c49fc2de576d76710af8fedc">Segments</a>[j].Type)</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                {</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="namespace_vect_sharp.html">VectSharp</a>.SegmentType.Move:</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                        this.MoveTo(textPath.<a class="code" href="class_vect_sharp_1_1_graphics_path.html#aabd97b02c49fc2de576d76710af8fedc">Segments</a>[j].Point.X, textPath.<a class="code" href="class_vect_sharp_1_1_graphics_path.html#aabd97b02c49fc2de576d76710af8fedc">Segments</a>[j].Point.Y);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="namespace_vect_sharp.html">VectSharp</a>.SegmentType.Line:</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                        this.LineTo(textPath.<a class="code" href="class_vect_sharp_1_1_graphics_path.html#aabd97b02c49fc2de576d76710af8fedc">Segments</a>[j].Point.X, textPath.<a class="code" href="class_vect_sharp_1_1_graphics_path.html#aabd97b02c49fc2de576d76710af8fedc">Segments</a>[j].Point.Y);</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="namespace_vect_sharp.html">VectSharp</a>.SegmentType.CubicBezier:</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                        this.CubicBezierTo(textPath.<a class="code" href="class_vect_sharp_1_1_graphics_path.html#aabd97b02c49fc2de576d76710af8fedc">Segments</a>[j].Points[0].X, textPath.<a class="code" href="class_vect_sharp_1_1_graphics_path.html#aabd97b02c49fc2de576d76710af8fedc">Segments</a>[j].Points[0].Y, textPath.<a class="code" href="class_vect_sharp_1_1_graphics_path.html#aabd97b02c49fc2de576d76710af8fedc">Segments</a>[j].Points[1].X, textPath.<a class="code" href="class_vect_sharp_1_1_graphics_path.html#aabd97b02c49fc2de576d76710af8fedc">Segments</a>[j].Points[1].Y, textPath.<a class="code" href="class_vect_sharp_1_1_graphics_path.html#aabd97b02c49fc2de576d76710af8fedc">Segments</a>[j].Points[2].X, textPath.<a class="code" href="class_vect_sharp_1_1_graphics_path.html#aabd97b02c49fc2de576d76710af8fedc">Segments</a>[j].Points[2].Y);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="namespace_vect_sharp.html">VectSharp</a>.SegmentType.Close:</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                        this.<a class="code" href="namespace_vect_sharp.html#ad82c158fff255cb1cbe8d51de61cb4e4ad3d2e617335f08df83599665eef8a418">Close</a>();</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                }</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;            }</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        }</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160; </div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> FillText(<span class="keywordtype">string</span> text, <span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y)</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        {</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;            <span class="keywordflow">if</span> (!_textToPaths)</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;            {</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                _figures.Add(<span class="keyword">new</span> TextFigure(text, <a class="code" href="class_vect_sharp_1_1_font.html">Font</a>, <span class="keyword">new</span> <a class="code" href="struct_vect_sharp_1_1_point.html">Point</a>(x, y), TextBaseline, _fillStyle, <span class="keyword">null</span>, 0, <a class="code" href="namespace_vect_sharp.html#a6bde58d6aab37ea51e32240503678209">LineCaps</a>.Butt, <a class="code" href="namespace_vect_sharp.html#a58a4a36ea254b3d255755654fd9e61f6">LineJoins</a>.Miter, <span class="keyword">new</span> <a class="code" href="struct_vect_sharp_1_1_line_dash.html">LineDash</a>(0, 0, 0), this.Tag));</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;            }</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            {</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                PathText(text, x, y);</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                Fill();</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;            }</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        }</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160; </div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        <span class="keyword">public</span> <a class="code" href="namespace_vect_sharp.html#acfad2994b272989b9cb471230d95334f">TextBaselines</a> TextBaseline { <span class="keyword">get</span>; <span class="keyword">set</span>; }</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160; </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> Restore()</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        {</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;            _figures.Add(<span class="keyword">new</span> TransformFigure(TransformFigure.TransformTypes.Restore, <span class="keyword">null</span>, <span class="keyword">this</span>.Tag));</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        }</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160; </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> Rotate(<span class="keywordtype">double</span> angle)</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        {</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;            _figures.Add(<span class="keyword">new</span> TransformFigure(TransformFigure.TransformTypes.Transform, <span class="keyword">new</span> <span class="keywordtype">double</span>[,] { { Math.Cos(angle), Math.Sin(angle), 0 }, { -Math.Sin(angle), Math.Cos(angle), 0 }, { 0, 0, 1 } }, this.Tag));</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        }</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160; </div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> Save()</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        {</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;            _figures.Add(<span class="keyword">new</span> TransformFigure(TransformFigure.TransformTypes.Save, <span class="keyword">null</span>, <span class="keyword">this</span>.Tag));</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        }</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160; </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160; </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> StrokeText(<span class="keywordtype">string</span> text, <span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y)</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        {</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;            <span class="keywordflow">if</span> (!_textToPaths)</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;            {</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                _figures.Add(<span class="keyword">new</span> TextFigure(text, <a class="code" href="class_vect_sharp_1_1_font.html">Font</a>, <span class="keyword">new</span> <a class="code" href="struct_vect_sharp_1_1_point.html">Point</a>(x, y), TextBaseline, <span class="keyword">null</span>, _strokeStyle, LineWidth, LineCap, LineJoin, _lineDash, this.Tag));</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;            }</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;            {</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                PathText(text, x, y);</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                Stroke();</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;            }</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        }</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160; </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> Translate(<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y)</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        {</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;            _figures.Add(<span class="keyword">new</span> TransformFigure(TransformFigure.TransformTypes.Transform, <span class="keyword">new</span> <span class="keywordtype">double</span>[,] { { 1, 0, x }, { 0, 1, y }, { 0, 0, 1 } }, this.Tag));</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        }</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160; </div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> Scale(<span class="keywordtype">double</span> scaleX, <span class="keywordtype">double</span> scaleY)</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        {</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;            _figures.Add(<span class="keyword">new</span> TransformFigure(TransformFigure.TransformTypes.Transform, <span class="keyword">new</span> <span class="keywordtype">double</span>[,] { { scaleX, 0, 0 }, { 0, scaleY, 0 }, { 0, 0, 1 } }, this.Tag));</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        }</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160; </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> Transform(<span class="keywordtype">double</span> a, <span class="keywordtype">double</span> b, <span class="keywordtype">double</span> c, <span class="keywordtype">double</span> d, <span class="keywordtype">double</span> e, <span class="keywordtype">double</span> f)</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        {</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;            _figures.Add(<span class="keyword">new</span> TransformFigure(TransformFigure.TransformTypes.Transform, <span class="keyword">new</span> <span class="keywordtype">double</span>[,] { { a, b, e }, { c, d, f }, { 0, 0, 1 } }, this.Tag));</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        }</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160; </div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> DrawRasterImage(<span class="keywordtype">int</span> sourceX, <span class="keywordtype">int</span> sourceY, <span class="keywordtype">int</span> sourceWidth, <span class="keywordtype">int</span> sourceHeight, <span class="keywordtype">double</span> destinationX, <span class="keywordtype">double</span> destinationY, <span class="keywordtype">double</span> destinationWidth, <span class="keywordtype">double</span> destinationHeight, RasterImage image)</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        {</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;            Save();</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160; </div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;            MoveTo(destinationX, destinationY);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;            LineTo(destinationX + destinationWidth, destinationY);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;            LineTo(destinationX + destinationWidth, destinationY + destinationHeight);</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;            LineTo(destinationX, destinationY + destinationHeight);</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;            <a class="code" href="namespace_vect_sharp.html#ad82c158fff255cb1cbe8d51de61cb4e4ad3d2e617335f08df83599665eef8a418">Close</a>();</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;            SetClippingPath();</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160; </div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;            <span class="keywordtype">double</span> sourceRectX = (double)sourceX / image.Width;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;            <span class="keywordtype">double</span> sourceRectY = 1 - (<span class="keywordtype">double</span>)sourceY / image.Height;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;            <span class="keywordtype">double</span> sourceRectWidth = (double)sourceWidth / image.Width;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;            <span class="keywordtype">double</span> sourceRectHeight = -(<span class="keywordtype">double</span>)sourceHeight / image.Height;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160; </div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;            <span class="keywordtype">double</span> scaleX = destinationWidth / sourceRectWidth;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;            <span class="keywordtype">double</span> scaleY = destinationHeight / sourceRectHeight;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160; </div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;            <span class="keywordtype">double</span> translationX = destinationX / scaleX - sourceRectX;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;            <span class="keywordtype">double</span> translationY = destinationY / scaleY - sourceRectY;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160; </div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160; </div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;            Scale(scaleX, scaleY);</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            Translate(translationX, translationY);</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160; </div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;            _figures.Add(<span class="keyword">new</span> RasterImageFigure(image, this.Tag));</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160; </div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;            Restore();</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        }</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    }</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">    /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">    /// Contains methods to render a &lt;see cref=&quot;Document&quot;/&gt; as a PDF document.</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment">    /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00585"></a><span class="lineno"><a class="line" href="class_vect_sharp_1_1_p_d_f_1_1_p_d_f_context_interpreter.html">  585</a></span>&#160;<span class="comment"></span>    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class </span><a class="code" href="class_vect_sharp_1_1_p_d_f_1_1_p_d_f_context_interpreter.html">PDFContextInterpreter</a></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    {</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">string</span> EscapeStringForPDF(<span class="keywordtype">string</span> str)</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        {</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;            StringBuilder sb = <span class="keyword">new</span> StringBuilder();</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160; </div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; str.Length; i++)</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;            {</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                <span class="keywordtype">char</span> ch = str[i];</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160; </div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                <span class="keywordflow">if</span> (CP1252Chars.Contains(ch))</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                {</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                    <span class="keywordflow">if</span> ((<span class="keywordtype">int</span>)ch &lt; 128)</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                    {</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                        <span class="keywordflow">if</span> (!<span class="stringliteral">&quot;\n\r\t\b\f()\\&quot;</span>.Contains(ch))</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                        {</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                            sb.Append(ch);</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                        }</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                        {</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                            <span class="keywordflow">switch</span> (ch)</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                            {</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                                <span class="keywordflow">case</span> <span class="charliteral">&#39;\n&#39;</span>:</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                                    sb.Append(<span class="stringliteral">&quot;\\n&quot;</span>);</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                                <span class="keywordflow">case</span> <span class="charliteral">&#39;\r&#39;</span>:</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                                    sb.Append(<span class="stringliteral">&quot;\\r&quot;</span>);</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                                <span class="keywordflow">case</span> <span class="charliteral">&#39;\t&#39;</span>:</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                                    sb.Append(<span class="stringliteral">&quot;\\t&quot;</span>);</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                                <span class="keywordflow">case</span> <span class="charliteral">&#39;\b&#39;</span>:</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                                    sb.Append(<span class="stringliteral">&quot;\\b&quot;</span>);</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                                <span class="keywordflow">case</span> <span class="charliteral">&#39;\f&#39;</span>:</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                                    sb.Append(<span class="stringliteral">&quot;\\f&quot;</span>);</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                                <span class="keywordflow">case</span> <span class="charliteral">&#39;\\&#39;</span>:</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                                    sb.Append(<span class="stringliteral">&quot;\\\\&quot;</span>);</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                                <span class="keywordflow">case</span> <span class="charliteral">&#39;(&#39;</span>:</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                                    sb.Append(<span class="stringliteral">&quot;\\(&quot;</span>);</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                                <span class="keywordflow">case</span> <span class="charliteral">&#39;)&#39;</span>:</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                                    sb.Append(<span class="stringliteral">&quot;\\)&quot;</span>);</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                            }</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                        }</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                    }</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                    {</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                        <span class="keywordtype">string</span> octal = Convert.ToString((<span class="keywordtype">int</span>)ch, 8);</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                        <span class="keywordflow">while</span> (octal.Length &lt; 3)</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                        {</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                            octal = <span class="stringliteral">&quot;0&quot;</span> + octal;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                        }</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                        sb.Append(<span class="stringliteral">&quot;\\&quot;</span> + octal);</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                    }</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                }</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                {</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                    sb.Append(<span class="charliteral">&#39;?&#39;</span>);</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                }</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;            }</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;            <span class="keywordflow">return</span> sb.ToString();</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        }</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160; </div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160; </div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">string</span> EscapeSymbolStringForPDF(<span class="keywordtype">string</span> str, Dictionary&lt;char, int&gt; glyphIndices)</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        {</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;            StringBuilder sb = <span class="keyword">new</span> StringBuilder();</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160; </div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; str.Length; i++)</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;            {</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                sb.Append((glyphIndices[str[i]]).ToString(<span class="stringliteral">&quot;X4&quot;</span>));</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;            }</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;            <span class="keywordflow">return</span> sb.ToString();</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        }</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160; </div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        <span class="keyword">private</span> <span class="keyword">static</span> Dictionary&lt;string, FontFamily&gt; GetFontFamilies(PDFContext[] pdfContexts)</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        {</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;            Dictionary&lt;string, FontFamily&gt; tbr = <span class="keyword">new</span> Dictionary&lt;string, FontFamily&gt;();</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160; </div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;            <span class="keywordflow">foreach</span> (PDFContext ctx <span class="keywordflow">in</span> pdfContexts)</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;            {</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                <span class="keywordflow">foreach</span> (IFigure act <span class="keywordflow">in</span> ctx._figures)</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                {</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                    <span class="keywordflow">if</span> (act is TextFigure figure &amp;&amp; !tbr.ContainsKey(figure.Font.FontFamily.FileName))</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                    {</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                        tbr.Add(figure.Font.FontFamily.FileName, <span class="keyword">new</span> <a class="code" href="class_vect_sharp_1_1_font_family.html">FontFamily</a>(figure.Font.FontFamily.FileName));</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                    }</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                }</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;            }</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160; </div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;            <span class="keywordflow">return</span> tbr;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        }</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160; </div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        <span class="keyword">private</span> <span class="keyword">static</span> Dictionary&lt;string, HashSet&lt;char&gt;&gt; GetUsedChars(PDFContext[] pdfContexts)</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        {</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;            Dictionary&lt;string, HashSet&lt;char&gt;&gt; tbr = <span class="keyword">new</span> Dictionary&lt;string, HashSet&lt;char&gt;&gt;();</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160; </div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;            <span class="keywordflow">foreach</span> (PDFContext ctx <span class="keywordflow">in</span> pdfContexts)</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;            {</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                <span class="keywordflow">foreach</span> (IFigure act <span class="keywordflow">in</span> ctx._figures)</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                {</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                    <span class="keywordflow">if</span> (act is TextFigure figure &amp;&amp; !tbr.ContainsKey(figure.Font.FontFamily.FileName))</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                    {</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                        tbr.Add(figure.Font.FontFamily.FileName, <span class="keyword">new</span> HashSet&lt;char&gt;(figure.Text));</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                    }</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (act is TextFigure figure1)</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                    {</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                        <span class="keywordtype">string</span> txt = figure1.Text;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; txt.Length; i++)</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                        {</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                            tbr[figure1.Font.FontFamily.FileName].Add(txt[i]);</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                        }</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                    }</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                }</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;            }</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160; </div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;            <span class="keywordflow">return</span> tbr;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        }</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160; </div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160; </div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">double</span>[] GetAlphas(PDFContext[] pdfContexts)</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        {</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;            HashSet&lt;double&gt; tbr = <span class="keyword">new</span> HashSet&lt;double&gt;();</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160; </div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;            tbr.Add(1);</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160; </div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;            <span class="keywordflow">foreach</span> (PDFContext ctx <span class="keywordflow">in</span> pdfContexts)</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;            {</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                <span class="keywordflow">foreach</span> (IFigure act <span class="keywordflow">in</span> ctx._figures)</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                {</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                    <span class="keywordflow">if</span> (act.Stroke.HasValue)</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                    {</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                        tbr.Add((<span class="keywordtype">double</span>)act.Stroke?.A);</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                    }</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160; </div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                    <span class="keywordflow">if</span> (act.Fill.HasValue)</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                    {</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                        tbr.Add((<span class="keywordtype">double</span>)act.Fill?.A);</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                    }</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                }</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;            }</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160; </div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;            <span class="keywordflow">return</span> tbr.ToArray();</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        }</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160; </div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        <span class="keyword">private</span> <span class="keyword">static</span> Dictionary&lt;string, RasterImage&gt; GetAllImages(PDFContext[] pdfContexts)</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;        {</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;            Dictionary&lt;string, RasterImage&gt; tbr = <span class="keyword">new</span> Dictionary&lt;string, RasterImage&gt;();</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160; </div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;            <span class="keywordflow">foreach</span> (PDFContext ctx <span class="keywordflow">in</span> pdfContexts)</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;            {</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                <span class="keywordflow">foreach</span> (IFigure act <span class="keywordflow">in</span> ctx._figures)</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                {</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                    <span class="keywordflow">if</span> (act is RasterImageFigure figure &amp;&amp; !tbr.ContainsKey(figure.Image.Id))</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                    {</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                        tbr.Add(figure.Image.Id, figure.Image);</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                    }</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                }</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;            }</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160; </div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;            <span class="keywordflow">return</span> tbr;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;        }</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160; </div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160; </div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        <span class="keyword">private</span> <span class="keyword">static</span> readonly <span class="keywordtype">char</span>[] CP1252Chars = <span class="keyword">new</span> <span class="keywordtype">char</span>[] { <span class="stringliteral">&#39;\u0000&#39;</span>, <span class="stringliteral">&#39;\u0001&#39;</span>, <span class="stringliteral">&#39;\u0002&#39;</span>, <span class="stringliteral">&#39;\u0003&#39;</span>, <span class="stringliteral">&#39;\u0004&#39;</span>, <span class="stringliteral">&#39;\u0005&#39;</span>, <span class="stringliteral">&#39;\u0006&#39;</span>, <span class="stringliteral">&#39;\u0007&#39;</span>, <span class="stringliteral">&#39;\u0008&#39;</span>, <span class="stringliteral">&#39;\u0009&#39;</span>, <span class="stringliteral">&#39;\u000A&#39;</span>, <span class="stringliteral">&#39;\u000B&#39;</span>, <span class="stringliteral">&#39;\u000C&#39;</span>, <span class="stringliteral">&#39;\u000D&#39;</span>, <span class="stringliteral">&#39;\u000E&#39;</span>, <span class="stringliteral">&#39;\u000F&#39;</span>, <span class="stringliteral">&#39;\u0010&#39;</span>, <span class="stringliteral">&#39;\u0011&#39;</span>, <span class="stringliteral">&#39;\u0012&#39;</span>, <span class="stringliteral">&#39;\u0013&#39;</span>, <span class="stringliteral">&#39;\u0014&#39;</span>, <span class="stringliteral">&#39;\u0015&#39;</span>, <span class="stringliteral">&#39;\u0016&#39;</span>, <span class="stringliteral">&#39;\u0017&#39;</span>, <span class="stringliteral">&#39;\u0018&#39;</span>, <span class="stringliteral">&#39;\u0019&#39;</span>, <span class="stringliteral">&#39;\u001A&#39;</span>, <span class="stringliteral">&#39;\u001B&#39;</span>, <span class="stringliteral">&#39;\u001C&#39;</span>, <span class="stringliteral">&#39;\u001D&#39;</span>, <span class="stringliteral">&#39;\u001E&#39;</span>, <span class="stringliteral">&#39;\u001F&#39;</span>, <span class="stringliteral">&#39;\u0020&#39;</span>, <span class="stringliteral">&#39;\u0021&#39;</span>, <span class="stringliteral">&#39;\u0022&#39;</span>, <span class="stringliteral">&#39;\u0023&#39;</span>, <span class="stringliteral">&#39;\u0024&#39;</span>, <span class="stringliteral">&#39;\u0025&#39;</span>, <span class="stringliteral">&#39;\u0026&#39;</span>, <span class="stringliteral">&#39;\u0027&#39;</span>, <span class="stringliteral">&#39;\u0028&#39;</span>, <span class="stringliteral">&#39;\u0029&#39;</span>, <span class="stringliteral">&#39;\u002A&#39;</span>, <span class="stringliteral">&#39;\u002B&#39;</span>, <span class="stringliteral">&#39;\u002C&#39;</span>, <span class="stringliteral">&#39;\u002D&#39;</span>, <span class="stringliteral">&#39;\u002E&#39;</span>, <span class="stringliteral">&#39;\u002F&#39;</span>, <span class="stringliteral">&#39;\u0030&#39;</span>, <span class="stringliteral">&#39;\u0031&#39;</span>, <span class="stringliteral">&#39;\u0032&#39;</span>, <span class="stringliteral">&#39;\u0033&#39;</span>, <span class="stringliteral">&#39;\u0034&#39;</span>, <span class="stringliteral">&#39;\u0035&#39;</span>, <span class="stringliteral">&#39;\u0036&#39;</span>, <span class="stringliteral">&#39;\u0037&#39;</span>, <span class="stringliteral">&#39;\u0038&#39;</span>, <span class="stringliteral">&#39;\u0039&#39;</span>, <span class="stringliteral">&#39;\u003A&#39;</span>, <span class="stringliteral">&#39;\u003B&#39;</span>, <span class="stringliteral">&#39;\u003C&#39;</span>, <span class="stringliteral">&#39;\u003D&#39;</span>, <span class="stringliteral">&#39;\u003E&#39;</span>, <span class="stringliteral">&#39;\u003F&#39;</span>, <span class="stringliteral">&#39;\u0040&#39;</span>, <span class="stringliteral">&#39;\u0041&#39;</span>, <span class="stringliteral">&#39;\u0042&#39;</span>, <span class="stringliteral">&#39;\u0043&#39;</span>, <span class="stringliteral">&#39;\u0044&#39;</span>, <span class="stringliteral">&#39;\u0045&#39;</span>, <span class="stringliteral">&#39;\u0046&#39;</span>, <span class="stringliteral">&#39;\u0047&#39;</span>, <span class="stringliteral">&#39;\u0048&#39;</span>, <span class="stringliteral">&#39;\u0049&#39;</span>, <span class="stringliteral">&#39;\u004A&#39;</span>, <span class="stringliteral">&#39;\u004B&#39;</span>, <span class="stringliteral">&#39;\u004C&#39;</span>, <span class="stringliteral">&#39;\u004D&#39;</span>, <span class="stringliteral">&#39;\u004E&#39;</span>, <span class="stringliteral">&#39;\u004F&#39;</span>, <span class="stringliteral">&#39;\u0050&#39;</span>, <span class="stringliteral">&#39;\u0051&#39;</span>, <span class="stringliteral">&#39;\u0052&#39;</span>, <span class="stringliteral">&#39;\u0053&#39;</span>, <span class="stringliteral">&#39;\u0054&#39;</span>, <span class="stringliteral">&#39;\u0055&#39;</span>, <span class="stringliteral">&#39;\u0056&#39;</span>, <span class="stringliteral">&#39;\u0057&#39;</span>, <span class="stringliteral">&#39;\u0058&#39;</span>, <span class="stringliteral">&#39;\u0059&#39;</span>, <span class="stringliteral">&#39;\u005A&#39;</span>, <span class="stringliteral">&#39;\u005B&#39;</span>, <span class="stringliteral">&#39;\u005C&#39;</span>, <span class="stringliteral">&#39;\u005D&#39;</span>, <span class="stringliteral">&#39;\u005E&#39;</span>, <span class="stringliteral">&#39;\u005F&#39;</span>, <span class="stringliteral">&#39;\u0060&#39;</span>, <span class="stringliteral">&#39;\u0061&#39;</span>, <span class="stringliteral">&#39;\u0062&#39;</span>, <span class="stringliteral">&#39;\u0063&#39;</span>, <span class="stringliteral">&#39;\u0064&#39;</span>, <span class="stringliteral">&#39;\u0065&#39;</span>, <span class="stringliteral">&#39;\u0066&#39;</span>, <span class="stringliteral">&#39;\u0067&#39;</span>, <span class="stringliteral">&#39;\u0068&#39;</span>, <span class="stringliteral">&#39;\u0069&#39;</span>, <span class="stringliteral">&#39;\u006A&#39;</span>, <span class="stringliteral">&#39;\u006B&#39;</span>, <span class="stringliteral">&#39;\u006C&#39;</span>, <span class="stringliteral">&#39;\u006D&#39;</span>, <span class="stringliteral">&#39;\u006E&#39;</span>, <span class="stringliteral">&#39;\u006F&#39;</span>, <span class="stringliteral">&#39;\u0070&#39;</span>, <span class="stringliteral">&#39;\u0071&#39;</span>, <span class="stringliteral">&#39;\u0072&#39;</span>, <span class="stringliteral">&#39;\u0073&#39;</span>, <span class="stringliteral">&#39;\u0074&#39;</span>, <span class="stringliteral">&#39;\u0075&#39;</span>, <span class="stringliteral">&#39;\u0076&#39;</span>, <span class="stringliteral">&#39;\u0077&#39;</span>, <span class="stringliteral">&#39;\u0078&#39;</span>, <span class="stringliteral">&#39;\u0079&#39;</span>, <span class="stringliteral">&#39;\u007A&#39;</span>, <span class="stringliteral">&#39;\u007B&#39;</span>, <span class="stringliteral">&#39;\u007C&#39;</span>, <span class="stringliteral">&#39;\u007D&#39;</span>, <span class="stringliteral">&#39;\u007E&#39;</span>, <span class="stringliteral">&#39;\u007F&#39;</span>, <span class="stringliteral">&#39;\u20AC&#39;</span>, <span class="stringliteral">&#39;\u25A1&#39;</span>, <span class="stringliteral">&#39;\u201A&#39;</span>, <span class="stringliteral">&#39;\u0192&#39;</span>, <span class="stringliteral">&#39;\u201E&#39;</span>, <span class="stringliteral">&#39;\u0000&#39;</span>, <span class="stringliteral">&#39;\u2020&#39;</span>, <span class="stringliteral">&#39;\u2021&#39;</span>, <span class="stringliteral">&#39;\u02C6&#39;</span>, <span class="stringliteral">&#39;\u2030&#39;</span>, <span class="stringliteral">&#39;\u0160&#39;</span>, <span class="stringliteral">&#39;\u2039&#39;</span>, <span class="stringliteral">&#39;\u0152&#39;</span>, <span class="stringliteral">&#39;\u25A1&#39;</span>, <span class="stringliteral">&#39;\u017D&#39;</span>, <span class="stringliteral">&#39;\u25A1&#39;</span>, <span class="stringliteral">&#39;\u25A1&#39;</span>, <span class="stringliteral">&#39;\u0000&#39;</span>, <span class="stringliteral">&#39;\u0000&#39;</span>, <span class="stringliteral">&#39;\u0000&#39;</span>, <span class="stringliteral">&#39;\u0000&#39;</span>, <span class="stringliteral">&#39;\u2022&#39;</span>, <span class="stringliteral">&#39;\u0000&#39;</span>, <span class="stringliteral">&#39;\u0000&#39;</span>, <span class="stringliteral">&#39;\u02DC&#39;</span>, <span class="stringliteral">&#39;\u2122&#39;</span>, <span class="stringliteral">&#39;\u0161&#39;</span>, <span class="stringliteral">&#39;\u203A&#39;</span>, <span class="stringliteral">&#39;\u0153&#39;</span>, <span class="stringliteral">&#39;\u25A1&#39;</span>, <span class="stringliteral">&#39;\u017E&#39;</span>, <span class="stringliteral">&#39;\u0178&#39;</span>, <span class="stringliteral">&#39;\u00A0&#39;</span>, <span class="stringliteral">&#39;\u00A1&#39;</span>, <span class="stringliteral">&#39;\u00A2&#39;</span>, <span class="stringliteral">&#39;\u00A3&#39;</span>, <span class="stringliteral">&#39;\u00A4&#39;</span>, <span class="stringliteral">&#39;\u00A5&#39;</span>, <span class="stringliteral">&#39;\u00A6&#39;</span>, <span class="stringliteral">&#39;\u00A7&#39;</span>, <span class="stringliteral">&#39;\u00A8&#39;</span>, <span class="stringliteral">&#39;\u00A9&#39;</span>, <span class="stringliteral">&#39;\u00AA&#39;</span>, <span class="stringliteral">&#39;\u00AB&#39;</span>, <span class="stringliteral">&#39;\u00AC&#39;</span>, <span class="stringliteral">&#39;\u00AD&#39;</span>, <span class="stringliteral">&#39;\u00AE&#39;</span>, <span class="stringliteral">&#39;\u00AF&#39;</span>, <span class="stringliteral">&#39;\u00B0&#39;</span>, <span class="stringliteral">&#39;\u00B1&#39;</span>, <span class="stringliteral">&#39;\u00B2&#39;</span>, <span class="stringliteral">&#39;\u00B3&#39;</span>, <span class="stringliteral">&#39;\u00B4&#39;</span>, <span class="stringliteral">&#39;\u00B5&#39;</span>, <span class="stringliteral">&#39;\u00B6&#39;</span>, <span class="stringliteral">&#39;\u00B7&#39;</span>, <span class="stringliteral">&#39;\u00B8&#39;</span>, <span class="stringliteral">&#39;\u00B9&#39;</span>, <span class="stringliteral">&#39;\u00BA&#39;</span>, <span class="stringliteral">&#39;\u00BB&#39;</span>, <span class="stringliteral">&#39;\u00BC&#39;</span>, <span class="stringliteral">&#39;\u00BD&#39;</span>, <span class="stringliteral">&#39;\u00BE&#39;</span>, <span class="stringliteral">&#39;\u00BF&#39;</span>, <span class="stringliteral">&#39;\u00C0&#39;</span>, <span class="stringliteral">&#39;\u00C1&#39;</span>, <span class="stringliteral">&#39;\u00C2&#39;</span>, <span class="stringliteral">&#39;\u00C3&#39;</span>, <span class="stringliteral">&#39;\u00C4&#39;</span>, <span class="stringliteral">&#39;\u00C5&#39;</span>, <span class="stringliteral">&#39;\u00C6&#39;</span>, <span class="stringliteral">&#39;\u00C7&#39;</span>, <span class="stringliteral">&#39;\u00C8&#39;</span>, <span class="stringliteral">&#39;\u00C9&#39;</span>, <span class="stringliteral">&#39;\u00CA&#39;</span>, <span class="stringliteral">&#39;\u00CB&#39;</span>, <span class="stringliteral">&#39;\u00CC&#39;</span>, <span class="stringliteral">&#39;\u00CD&#39;</span>, <span class="stringliteral">&#39;\u00CE&#39;</span>, <span class="stringliteral">&#39;\u00CF&#39;</span>, <span class="stringliteral">&#39;\u00D0&#39;</span>, <span class="stringliteral">&#39;\u00D1&#39;</span>, <span class="stringliteral">&#39;\u00D2&#39;</span>, <span class="stringliteral">&#39;\u00D3&#39;</span>, <span class="stringliteral">&#39;\u00D4&#39;</span>, <span class="stringliteral">&#39;\u00D5&#39;</span>, <span class="stringliteral">&#39;\u00D6&#39;</span>, <span class="stringliteral">&#39;\u00D7&#39;</span>, <span class="stringliteral">&#39;\u00D8&#39;</span>, <span class="stringliteral">&#39;\u00D9&#39;</span>, <span class="stringliteral">&#39;\u00DA&#39;</span>, <span class="stringliteral">&#39;\u00DB&#39;</span>, <span class="stringliteral">&#39;\u00DC&#39;</span>, <span class="stringliteral">&#39;\u00DD&#39;</span>, <span class="stringliteral">&#39;\u00DE&#39;</span>, <span class="stringliteral">&#39;\u00DF&#39;</span>, <span class="stringliteral">&#39;\u00E0&#39;</span>, <span class="stringliteral">&#39;\u00E1&#39;</span>, <span class="stringliteral">&#39;\u00E2&#39;</span>, <span class="stringliteral">&#39;\u00E3&#39;</span>, <span class="stringliteral">&#39;\u00E4&#39;</span>, <span class="stringliteral">&#39;\u00E5&#39;</span>, <span class="stringliteral">&#39;\u00E6&#39;</span>, <span class="stringliteral">&#39;\u00E7&#39;</span>, <span class="stringliteral">&#39;\u00E8&#39;</span>, <span class="stringliteral">&#39;\u00E9&#39;</span>, <span class="stringliteral">&#39;\u00EA&#39;</span>, <span class="stringliteral">&#39;\u00EB&#39;</span>, <span class="stringliteral">&#39;\u00EC&#39;</span>, <span class="stringliteral">&#39;\u00ED&#39;</span>, <span class="stringliteral">&#39;\u00EE&#39;</span>, <span class="stringliteral">&#39;\u00EF&#39;</span>, <span class="stringliteral">&#39;\u00F0&#39;</span>, <span class="stringliteral">&#39;\u00F1&#39;</span>, <span class="stringliteral">&#39;\u00F2&#39;</span>, <span class="stringliteral">&#39;\u00F3&#39;</span>, <span class="stringliteral">&#39;\u00F4&#39;</span>, <span class="stringliteral">&#39;\u00F5&#39;</span>, <span class="stringliteral">&#39;\u00F6&#39;</span>, <span class="stringliteral">&#39;\u00F7&#39;</span>, <span class="stringliteral">&#39;\u00F8&#39;</span>, <span class="stringliteral">&#39;\u00F9&#39;</span>, <span class="stringliteral">&#39;\u00FA&#39;</span>, <span class="stringliteral">&#39;\u00FB&#39;</span>, <span class="stringliteral">&#39;\u00FC&#39;</span>, <span class="stringliteral">&#39;\u00FD&#39;</span>, <span class="stringliteral">&#39;\u00FE&#39;</span>, <span class="stringliteral">&#39;\u00FF&#39;</span> };</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="comment">        /// Save the document to a PDF file.</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="comment">        /// &lt;param name=&quot;document&quot;&gt;The &lt;see cref=&quot;Document&quot;/&gt; to save.&lt;/param&gt;</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="comment">        /// &lt;param name=&quot;fileName&quot;&gt;The full path to the file to save. If it exists, it will be overwritten.&lt;/param&gt;</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="comment">        /// &lt;param name=&quot;textOption&quot;&gt;Defines whether the used fonts should be included in the file.&lt;/param&gt;</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="comment">        /// &lt;param name=&quot;compressStreams&quot;&gt;Indicates whether the streams in the PDF file should be compressed.&lt;/param&gt;</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="comment">        /// &lt;param name=&quot;linkDestinations&quot;&gt;A dictionary associating element tags to link targets. If this is provided, objects that have been drawn with a tag contained in the dictionary will become hyperlink to the destination specified in the dictionary. If the destination starts with a hash (#), it is interpreted as the tag of another object in the current document; otherwise, it is interpreted as an external URI.&lt;/param&gt;</span></div>
<div class="line"><a name="l00763"></a><span class="lineno"><a class="line" href="class_vect_sharp_1_1_p_d_f_1_1_p_d_f_context_interpreter.html#ac369a9c6df21b7e929fc91cea604c05e">  763</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="class_vect_sharp_1_1_p_d_f_1_1_p_d_f_context_interpreter.html#ac369a9c6df21b7e929fc91cea604c05e">SaveAsPDF</a>(<span class="keyword">this</span> <a class="code" href="class_vect_sharp_1_1_document.html">Document</a> document, <span class="keywordtype">string</span> fileName, <a class="code" href="class_vect_sharp_1_1_p_d_f_1_1_p_d_f_context_interpreter.html#a8cd1a292b80db0cce76c229f069899fe">TextOptions</a> textOption = <a class="code" href="class_vect_sharp_1_1_p_d_f_1_1_p_d_f_context_interpreter.html#a8cd1a292b80db0cce76c229f069899fe">TextOptions</a>.SubsetFonts, <span class="keywordtype">bool</span> compressStreams = <span class="keyword">true</span>, Dictionary&lt;string, string&gt; linkDestinations = <span class="keyword">null</span>)</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        {</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;            <span class="keyword">using</span> (FileStream stream = <span class="keyword">new</span> FileStream(fileName, FileMode.Create))</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;            {</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                document.SaveAsPDF(stream, textOption, compressStreams, linkDestinations);</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;            }</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        }</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="comment">        /// Defines whether the used fonts should be included in the file.</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00774"></a><span class="lineno"><a class="line" href="class_vect_sharp_1_1_p_d_f_1_1_p_d_f_context_interpreter.html#a8cd1a292b80db0cce76c229f069899fe">  774</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keyword">enum</span> <a class="code" href="class_vect_sharp_1_1_p_d_f_1_1_p_d_f_context_interpreter.html#a8cd1a292b80db0cce76c229f069899fe">TextOptions</a></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;        {<span class="comment"></span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="comment">            /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="comment">            /// Embeds subsetted font files containing only the glyphs for the characters that have been used.</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="comment">            /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="comment"></span>            SubsetFonts,</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;<span class="comment">            /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;<span class="comment">            /// Does not embed any font file and converts all text items into paths.</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="comment">            /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;<span class="comment"></span>            ConvertIntoPaths</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        }</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160; </div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160; </div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<span class="comment">        /// &lt;summary&gt;</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;<span class="comment">        /// Save the document to a PDF stream.</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="comment">        /// &lt;/summary&gt;</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="comment">        /// &lt;param name=&quot;document&quot;&gt;The &lt;see cref=&quot;Document&quot;/&gt; to save.&lt;/param&gt;</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="comment">        /// &lt;param name=&quot;stream&quot;&gt;The stream to which the PDF data will be written.&lt;/param&gt;</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;<span class="comment">        /// &lt;param name=&quot;textOption&quot;&gt;Defines whether the used fonts should be included in the file.&lt;/param&gt;</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="comment">        /// &lt;param name=&quot;compressStreams&quot;&gt;Indicates whether the streams in the PDF file should be compressed.&lt;/param&gt;</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="comment">        /// &lt;param name=&quot;linkDestinations&quot;&gt;A dictionary associating element tags to link targets. If this is provided, objects that have been drawn with a tag contained in the dictionary will become hyperlink to the destination specified in the dictionary. If the destination starts with a hash (#), it is interpreted as the tag of another object in the current document; otherwise, it is interpreted as an external URI.&lt;/param&gt;</span></div>
<div class="line"><a name="l00797"></a><span class="lineno"><a class="line" href="class_vect_sharp_1_1_p_d_f_1_1_p_d_f_context_interpreter.html#aa7f62148731cd2906243f2b2ba76d8fc">  797</a></span>&#160;<span class="comment"></span>        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="class_vect_sharp_1_1_p_d_f_1_1_p_d_f_context_interpreter.html#aa7f62148731cd2906243f2b2ba76d8fc">SaveAsPDF</a>(<span class="keyword">this</span> <a class="code" href="class_vect_sharp_1_1_document.html">Document</a> document, Stream stream, <a class="code" href="class_vect_sharp_1_1_p_d_f_1_1_p_d_f_context_interpreter.html#a8cd1a292b80db0cce76c229f069899fe">TextOptions</a> textOption = <a class="code" href="class_vect_sharp_1_1_p_d_f_1_1_p_d_f_context_interpreter.html#a8cd1a292b80db0cce76c229f069899fe">TextOptions</a>.SubsetFonts, <span class="keywordtype">bool</span> compressStreams = <span class="keyword">true</span>, Dictionary&lt;string, string&gt; linkDestinations = <span class="keyword">null</span>)</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        {</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;            <span class="keywordflow">if</span> (linkDestinations == <span class="keyword">null</span>)</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;            {</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                linkDestinations = <span class="keyword">new</span> Dictionary&lt;string, string&gt;();</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;            }</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160; </div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;            <span class="keywordtype">long</span> position = 0;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160; </div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;            List&lt;long&gt; objectPositions = <span class="keyword">new</span> List&lt;long&gt;();</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160; </div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;            <span class="keywordtype">int</span> objectNum = 1;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;            <span class="keywordtype">string</span> currObject = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160; </div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;            <span class="keywordtype">int</span> resourceObject = -1;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160; </div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;            StreamWriter sw = <span class="keyword">new</span> StreamWriter(stream, Encoding.GetEncoding(<span class="stringliteral">&quot;ISO-8859-1&quot;</span>), 1024, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160; </div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;            <span class="comment">//Header</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;            sw.Write(<span class="stringliteral">&quot;%PDF-1.4\n&quot;</span>);</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;            position += 9;</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160; </div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;            PDFContext[] pageContexts = <span class="keyword">new</span> PDFContext[document.<a class="code" href="class_vect_sharp_1_1_document.html#a37c0a15de4cf1ce2ea3bc6ae074c18c9">Pages</a>.Count];</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160; </div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; document.<a class="code" href="class_vect_sharp_1_1_document.html#a37c0a15de4cf1ce2ea3bc6ae074c18c9">Pages</a>.Count; i++)</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;            {</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                pageContexts[i] = <span class="keyword">new</span> PDFContext(document.<a class="code" href="class_vect_sharp_1_1_document.html#a37c0a15de4cf1ce2ea3bc6ae074c18c9">Pages</a>[i].Width, document.<a class="code" href="class_vect_sharp_1_1_document.html#a37c0a15de4cf1ce2ea3bc6ae074c18c9">Pages</a>[i].Height, document.<a class="code" href="class_vect_sharp_1_1_document.html#a37c0a15de4cf1ce2ea3bc6ae074c18c9">Pages</a>[i].Background, textOption == <a class="code" href="class_vect_sharp_1_1_p_d_f_1_1_p_d_f_context_interpreter.html#a8cd1a292b80db0cce76c229f069899fe">TextOptions</a>.ConvertIntoPaths);</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;                document.<a class="code" href="class_vect_sharp_1_1_document.html#a37c0a15de4cf1ce2ea3bc6ae074c18c9">Pages</a>[i].Graphics.CopyToIGraphicsContext(pageContexts[i]);</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;            }</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160; </div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;            Dictionary&lt;string, FontFamily&gt; allFontFamilies = GetFontFamilies(pageContexts);</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;            Dictionary&lt;string, HashSet&lt;char&gt;&gt; usedChars = GetUsedChars(pageContexts);</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;            Dictionary&lt;string, int&gt; fontObjectNums = <span class="keyword">new</span> Dictionary&lt;string, int&gt;();</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;            Dictionary&lt;string, string&gt; symbolFontIDs = <span class="keyword">new</span> Dictionary&lt;string, string&gt;();</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;            Dictionary&lt;string, string&gt; nonSymbolFontIDs = <span class="keyword">new</span> Dictionary&lt;string, string&gt;();</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;            Dictionary&lt;string, Dictionary&lt;char, int&gt;&gt; symbolGlyphIndices = <span class="keyword">new</span> Dictionary&lt;string, Dictionary&lt;char, int&gt;&gt;();</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;            <span class="keywordtype">double</span>[] alphas = GetAlphas(pageContexts);</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;            Dictionary&lt;string, RasterImage&gt; allImages = GetAllImages(pageContexts);</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;            Dictionary&lt;string, int&gt; imageObjectNums = <span class="keyword">new</span> Dictionary&lt;string, int&gt;();</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160; </div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;            <span class="keywordtype">int</span> fontId = 1;</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160; </div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;            <span class="keywordflow">foreach</span> (KeyValuePair&lt;string, FontFamily&gt; kvp <span class="keywordflow">in</span> allFontFamilies)</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;            {</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                List&lt;char&gt; nonSymbol = <span class="keyword">new</span> List&lt;char&gt;();</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                List&lt;char&gt; symbol = <span class="keyword">new</span> List&lt;char&gt;();</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160; </div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                <span class="keywordflow">foreach</span> (<span class="keywordtype">char</span> c <span class="keywordflow">in</span> usedChars[kvp.Key])</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                {</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                    <span class="keywordflow">if</span> (CP1252Chars.Contains(c))</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                    {</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                        nonSymbol.Add(c);</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                    }</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                    {</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                        symbol.Add(c);</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                    }</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                }</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160; </div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                <span class="comment">//Font</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                <span class="keywordflow">if</span> (((kvp.Value.IsStandardFamily &amp;&amp; kvp.Value.FileName != <span class="stringliteral">&quot;Symbol&quot;</span> &amp;&amp; kvp.Value.FileName != <span class="stringliteral">&quot;ZapfDingbats&quot;</span>) &amp;&amp; symbol.Count == 0) || kvp.Value.TrueTypeFile == <span class="keyword">null</span>)</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                {</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;                    fontObjectNums.Add(<span class="stringliteral">&quot;nonsymbol: &quot;</span> + kvp.Key, objectNum);</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                    fontObjectNums.Add(<span class="stringliteral">&quot;symbol: &quot;</span> + kvp.Key, objectNum);</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                    nonSymbolFontIDs.Add(kvp.Key, <span class="stringliteral">&quot;F&quot;</span> + fontId.ToString());</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                    symbolFontIDs.Add(kvp.Key, <span class="stringliteral">&quot;F&quot;</span> + fontId.ToString());</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                    objectPositions.Add(position);</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                    currObject = objectNum.ToString() + <span class="stringliteral">&quot; 0 obj\n&lt;&lt; /Type /Font /Subtype /Type1 /BaseFont /&quot;</span> + kvp.Key + <span class="stringliteral">&quot; &gt;&gt;\nendobj\n&quot;</span>;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                    sw.Write(currObject);</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                    position += currObject.Length;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                    objectNum++;</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                    fontId++;</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                }</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                {</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                    <span class="keywordtype">int</span> fontFileInd = objectNum;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160; </div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                    <a class="code" href="class_vect_sharp_1_1_true_type_file.html">TrueTypeFile</a> subsettedFont = kvp.Value.TrueTypeFile.SubsetFont(<span class="keyword">new</span> <span class="keywordtype">string</span>(usedChars[kvp.Key].ToArray()));</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160; </div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                    Stream compressedStream;</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160; </div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                    <span class="keywordflow">if</span> (!compressStreams)</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                    {</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                        compressedStream = subsettedFont.<a class="code" href="class_vect_sharp_1_1_true_type_file.html#a8df9028202564d2a8ca841102e558a1f">FontStream</a>;</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                    }</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                    {</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                        compressedStream = ZLibCompress(subsettedFont.<a class="code" href="class_vect_sharp_1_1_true_type_file.html#a8df9028202564d2a8ca841102e558a1f">FontStream</a>);</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                    }</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160; </div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                    <span class="keywordtype">long</span> length = compressedStream.Length;</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160; </div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                    objectPositions.Add(position);</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;                    currObject = objectNum.ToString() + <span class="stringliteral">&quot; 0 obj\n&lt;&lt; /Length &quot;</span> + length.ToString() + <span class="stringliteral">&quot; /Length1 &quot;</span> + subsettedFont.<a class="code" href="class_vect_sharp_1_1_true_type_file.html#a8df9028202564d2a8ca841102e558a1f">FontStream</a>.Length.ToString();</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160; </div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                    <span class="keywordflow">if</span> (compressStreams)</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;                    {</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;                        currObject += <span class="stringliteral">&quot; /Filter [ /FlateDecode ]&quot;</span>;</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                    }</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160; </div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;                    currObject += <span class="stringliteral">&quot; &gt;&gt;\nstream\n&quot;</span>;</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                    sw.Write(currObject);</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;                    position += currObject.Length;</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                    sw.Flush();</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160; </div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                    compressedStream.Seek(0, SeekOrigin.Begin);</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                    compressedStream.CopyTo(stream);</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160; </div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                    position += length;</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                    currObject = <span class="stringliteral">&quot;endstream\nendobj\n&quot;</span>;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                    sw.Write(currObject);</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                    position += currObject.Length;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                    objectNum++;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160; </div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160; </div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                    <span class="keywordflow">if</span> (nonSymbol.Count &gt; 0)</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                    {</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                        PDFFontDescriptor desc = <span class="keyword">new</span> PDFFontDescriptor(subsettedFont, <span class="keyword">true</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160; </div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                        <span class="keywordtype">int</span> fontDescriptorInd = objectNum;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                        objectPositions.Add(position);</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160; </div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                        currObject = objectNum.ToString() + <span class="stringliteral">&quot; 0 obj\n&lt;&lt; /Type /FontDescriptor /FontName /&quot;</span> + desc.FontName + <span class="stringliteral">&quot; /FontFamily (&quot;</span> + EscapeStringForPDF(desc.FontFamily) + <span class="stringliteral">&quot;) /Flags &quot;</span> + desc.Flags.ToString();</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                        currObject += <span class="stringliteral">&quot; /FontBBox [ &quot;</span> + desc.FontBBox[0].ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; &quot;</span> + desc.FontBBox[1].ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; &quot;</span> + desc.FontBBox[2].ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; &quot;</span> + desc.FontBBox[3].ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; ] /ItalicAngle &quot;</span> + desc.ItalicAngle.ToString();</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                        currObject += <span class="stringliteral">&quot; /Ascent &quot;</span> + desc.Ascent.ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; /Descent &quot;</span> + desc.Descent.ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; /CapHeight &quot;</span> + desc.CapHeight.ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; /StemV &quot;</span> + desc.StemV.ToString() + <span class="stringliteral">&quot; /StemH &quot;</span> + desc.StemH.ToString() + <span class="stringliteral">&quot; /FontFile2 &quot;</span> + fontFileInd.ToString() + <span class="stringliteral">&quot; 0 R &gt;&gt;\nendobj\n&quot;</span>;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                        sw.Write(currObject);</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                        position += currObject.Length;</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                        objectNum++;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160; </div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160; </div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                        fontObjectNums.Add(<span class="stringliteral">&quot;nonsymbol: &quot;</span> + kvp.Key, objectNum);</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                        nonSymbolFontIDs.Add(kvp.Key, <span class="stringliteral">&quot;F&quot;</span> + fontId.ToString());</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                        objectPositions.Add(position);</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160; </div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                        <span class="keywordtype">int</span> firstChar = (from el in nonSymbol select Array.IndexOf(CP1252Chars, el)).Min();</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                        <span class="keywordtype">int</span> lastChar = (from el in nonSymbol select Array.IndexOf(CP1252Chars, el)).Max();</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160; </div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                        currObject = objectNum.ToString() + <span class="stringliteral">&quot; 0 obj\n&lt;&lt; /Type /Font /Subtype /TrueType /BaseFont /&quot;</span> + desc.FontName + <span class="stringliteral">&quot; /FirstChar &quot;</span> + firstChar.ToString() + <span class="stringliteral">&quot; /LastChar &quot;</span> + lastChar.ToString() + <span class="stringliteral">&quot; /FontDescriptor &quot;</span> + fontDescriptorInd.ToString() + <span class="stringliteral">&quot; 0 R /Encoding /WinAnsiEncoding /Widths [ &quot;</span>;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160; </div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = firstChar; i &lt;= lastChar; i++)</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                        {</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                            <span class="keywordflow">if</span> (nonSymbol.Contains(CP1252Chars[i]))</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                            {</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                                currObject += subsettedFont.<a class="code" href="class_vect_sharp_1_1_true_type_file.html#a78be18e6d87950d5d1bbaf1970a00564">Get1000EmGlyphWidth</a>(CP1252Chars[i]).ToString() + <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                            }</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                            {</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                                currObject += <span class="stringliteral">&quot;0 &quot;</span>;</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                            }</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                        }</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160; </div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                        currObject += <span class="stringliteral">&quot;] &gt;&gt;\nendobj\n&quot;</span>;</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                        sw.Write(currObject);</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                        position += currObject.Length;</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                        objectNum++;</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                        fontId++;</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                    }</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160; </div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160; </div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;                    <span class="keywordflow">if</span> (symbol.Count &gt; 0)</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                    {</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                        PDFFontDescriptor desc = <span class="keyword">new</span> PDFFontDescriptor(subsettedFont, <span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160; </div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                        <span class="keywordtype">int</span> fontDescriptorInd = objectNum;</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                        objectPositions.Add(position);</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160; </div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                        currObject = objectNum.ToString() + <span class="stringliteral">&quot; 0 obj\n&lt;&lt; /Type /FontDescriptor /FontName /&quot;</span> + desc.FontName + <span class="stringliteral">&quot; /FontFamily (&quot;</span> + EscapeStringForPDF(desc.FontFamily) + <span class="stringliteral">&quot;) /Flags &quot;</span> + desc.Flags.ToString();</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                        currObject += <span class="stringliteral">&quot; /FontBBox [ &quot;</span> + desc.FontBBox[0].ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; &quot;</span> + desc.FontBBox[1].ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; &quot;</span> + desc.FontBBox[2].ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; &quot;</span> + desc.FontBBox[3].ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; ] /ItalicAngle &quot;</span> + desc.ItalicAngle.ToString();</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                        currObject += <span class="stringliteral">&quot; /Ascent &quot;</span> + desc.Ascent.ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; /Descent &quot;</span> + desc.Descent.ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; /CapHeight &quot;</span> + desc.CapHeight.ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; /StemV &quot;</span> + desc.StemV.ToString() + <span class="stringliteral">&quot; /StemH &quot;</span> + desc.StemH.ToString() + <span class="stringliteral">&quot; /FontFile2 &quot;</span> + fontFileInd.ToString() + <span class="stringliteral">&quot; 0 R &gt;&gt;\nendobj\n&quot;</span>;</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;                        sw.Write(currObject);</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;                        position += currObject.Length;</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;                        objectNum++;</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160; </div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160; </div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;                        Dictionary&lt;char, int&gt; glyphIndices = <span class="keyword">new</span> Dictionary&lt;char, int&gt;();</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160; </div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; symbol.Count; i++)</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                        {</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                            glyphIndices.Add(symbol[i], subsettedFont.<a class="code" href="class_vect_sharp_1_1_true_type_file.html#a9c43d885920fab37a9314aa390453bc3">GetGlyphIndex</a>(symbol[i]));</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                        }</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160; </div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                        symbolGlyphIndices.Add(kvp.Key, glyphIndices);</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160; </div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;                        <span class="keywordtype">int</span> descendantFontInd = objectNum;</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                        objectPositions.Add(position);</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                        currObject = objectNum.ToString() + <span class="stringliteral">&quot; 0 obj\n&lt;&lt; /Type /Font /Subtype /CIDFontType2 /BaseFont /&quot;</span> + desc.FontName + <span class="stringliteral">&quot; /CIDSystemInfo &lt;&lt; /Registry (Adobe) /Ordering (Identity) /Supplement 0 &gt;&gt; /FontDescriptor &quot;</span> + fontDescriptorInd.ToString() + <span class="stringliteral">&quot; 0 R &quot;</span>;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                        currObject += <span class="stringliteral">&quot;/W [ &quot;</span>;</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160; </div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; symbol.Count; i++)</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;                        {</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;                            currObject += glyphIndices[symbol[i]].ToString() + <span class="stringliteral">&quot; [ &quot;</span>;</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                            currObject += subsettedFont.<a class="code" href="class_vect_sharp_1_1_true_type_file.html#a78be18e6d87950d5d1bbaf1970a00564">Get1000EmGlyphWidth</a>(symbol[i]).ToString() + <span class="stringliteral">&quot; ] &quot;</span>;</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;                        }</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160; </div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                        currObject += <span class="stringliteral">&quot;] &gt;&gt;\nendobj\n&quot;</span>;</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                        sw.Write(currObject);</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;                        position += currObject.Length;</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                        objectNum++;</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160; </div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160; </div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;                        <span class="keywordtype">string</span> toUnicodeStream = <span class="stringliteral">&quot;/CIDInit /ProcSet findresource begin\n12 dict begin\nbegincmap\n/CIDSystemInfo &lt;&lt; /Registry (Adobe) /Ordering (UCS) /Supplement 0 &gt;&gt; def\n&quot;</span>;</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;                        toUnicodeStream += <span class="stringliteral">&quot;/CMapName /Adobe-Identity-UCS def\n/CMapType 2 def\n1 begincodespacerange\n&lt;0000&gt; &lt;ffff&gt;\nendcodespacerange\n1 beginbfchar\n&quot;</span>;</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; symbol.Count; i++)</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;                        {</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;                            toUnicodeStream += <span class="stringliteral">&quot;&lt;&quot;</span> + glyphIndices[symbol[i]].ToString(<span class="stringliteral">&quot;X4&quot;</span>) + <span class="stringliteral">&quot;&gt; &lt;&quot;</span> + ((int)symbol[i]).ToString(<span class="stringliteral">&quot;X4&quot;</span>) + <span class="stringliteral">&quot;&gt;\n&quot;</span>;</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;                        }</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;                        toUnicodeStream += <span class="stringliteral">&quot;endbfchar\nendcmap\nCmapName currentdict /CMap defineresource pop\nend\nend\n&quot;</span>;</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160; </div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;                        MemoryStream uncompressedUnicode = <span class="keyword">new</span> MemoryStream();</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160; </div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;                        <span class="keyword">using</span> (StreamWriter usw = <span class="keyword">new</span> StreamWriter(uncompressedUnicode, Encoding.ASCII, 1024, <span class="keyword">true</span>))</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                        {</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;                            usw.Write(toUnicodeStream);</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;                        }</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160; </div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;                        uncompressedUnicode.Seek(0, SeekOrigin.Begin);</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160; </div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;                        MemoryStream compressedToUnicode;</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160; </div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                        <span class="keywordflow">if</span> (!compressStreams)</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                        {</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;                            compressedToUnicode = uncompressedUnicode;</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;                        }</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                        {</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                            compressedToUnicode = ZLibCompress(uncompressedUnicode);</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;                        }</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160; </div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;                        <span class="keywordtype">long</span> unicodeLength = compressedToUnicode.Length;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160; </div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                        <span class="keywordtype">int</span> toUnicodeInd = objectNum;</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                        objectPositions.Add(position);</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                        currObject = objectNum.ToString() + <span class="stringliteral">&quot; 0 obj\n&lt;&lt; /Length &quot;</span> + unicodeLength;</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160; </div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                        <span class="keywordflow">if</span> (compressStreams)</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                        {</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                            currObject += <span class="stringliteral">&quot; /Filter [ /FlateDecode ]&quot;</span>;</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                        }</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160; </div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                        currObject += <span class="stringliteral">&quot; &gt;&gt;\nstream\n&quot;</span>;</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160; </div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                        sw.Write(currObject);</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                        position += currObject.Length;</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                        sw.Flush();</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160; </div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                        compressedToUnicode.WriteTo(stream);</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                        position += unicodeLength;</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160; </div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                        currObject = <span class="stringliteral">&quot;endstream\nendobj\n&quot;</span>;</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;                        sw.Write(currObject);</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                        position += currObject.Length;</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                        objectNum++;</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160; </div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160; </div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                        fontObjectNums.Add(<span class="stringliteral">&quot;symbol: &quot;</span> + kvp.Key, objectNum);</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;                        symbolFontIDs.Add(kvp.Key, <span class="stringliteral">&quot;F&quot;</span> + fontId.ToString());</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;                        objectPositions.Add(position);</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;                        currObject = objectNum.ToString() + <span class="stringliteral">&quot; 0 obj\n&lt;&lt; /Type /Font /Subtype /Type0 /BaseFont /&quot;</span> + desc.FontName + <span class="stringliteral">&quot; /Encoding /Identity-H /DescendantFonts [ &quot;</span> + descendantFontInd.ToString() + <span class="stringliteral">&quot; 0 R ] /ToUnicode &quot;</span> + toUnicodeInd.ToString() + <span class="stringliteral">&quot; 0 R &gt;&gt;\nendobj\n&quot;</span>;</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;                        sw.Write(currObject);</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;                        position += currObject.Length;</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;                        objectNum++;</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;                        fontId++;</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;                    }</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                }</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;            }</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160; </div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;            <span class="keywordflow">foreach</span> (KeyValuePair&lt;string, RasterImage&gt; img <span class="keywordflow">in</span> allImages)</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;            {</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;                <a class="code" href="class_vect_sharp_1_1_raster_image.html">RasterImage</a> image = img.Value;</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                <span class="keywordtype">int</span> stride = image.<a class="code" href="class_vect_sharp_1_1_raster_image.html#a5c022bcd18b4e37c26df5ec67c8c2b71">Width</a> * (image.<a class="code" href="class_vect_sharp_1_1_raster_image.html#a3012ff06029d327b3a280260fb2207f2">HasAlpha</a> ? 4 : 3);</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160; </div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;                <span class="keywordtype">string</span> filter = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160; </div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;                <span class="keywordflow">if</span> (image.<a class="code" href="class_vect_sharp_1_1_raster_image.html#a3012ff06029d327b3a280260fb2207f2">HasAlpha</a>)</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                {</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;                    objectPositions.Add(position);</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160; </div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;                    filter = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;                    MemoryStream alphaStream = <span class="keyword">new</span> MemoryStream();</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160; </div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;                    unsafe</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                    {</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                        <span class="keywordtype">byte</span>* dataPointer = (<span class="keywordtype">byte</span>*)image.<a class="code" href="class_vect_sharp_1_1_raster_image.html#aaa0c2c00b3f570797d0eb31ea899dae2">ImageDataAddress</a>;</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160; </div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                        if (compressStreams)</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;                        {</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;                            filter = <span class="stringliteral">&quot;/FlateDecode&quot;</span>;</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160; </div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> y = 0; y &lt; image.<a class="code" href="class_vect_sharp_1_1_raster_image.html#a7fdcc792321aae93369d85c280bf696c">Height</a>; y++)</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                            {</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;                                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x = 0; x &lt; image.<a class="code" href="class_vect_sharp_1_1_raster_image.html#a5c022bcd18b4e37c26df5ec67c8c2b71">Width</a>; x++)</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                                {</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;                                    dataPointer += 3;</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                                    alphaStream.WriteByte(*dataPointer);</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                                    dataPointer++;</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                                }</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;                            }</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160; </div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;                            alphaStream.Seek(0, SeekOrigin.Begin);</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;                            MemoryStream compressed = ZLibCompress(alphaStream);</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;                            alphaStream.Dispose();</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;                            alphaStream = compressed;</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;                        }</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;                        {</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;                            filter = <span class="stringliteral">&quot;/ASCIIHexDecode&quot;</span>;</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160; </div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;                            <span class="keyword">using</span> (StreamWriter imageWriter = <span class="keyword">new</span> StreamWriter(alphaStream, Encoding.ASCII, 1024, <span class="keyword">true</span>))</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;                            {</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;                                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> y = 0; y &lt; image.<a class="code" href="class_vect_sharp_1_1_raster_image.html#a7fdcc792321aae93369d85c280bf696c">Height</a>; y++)</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;                                {</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;                                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x = 0; x &lt; image.<a class="code" href="class_vect_sharp_1_1_raster_image.html#a5c022bcd18b4e37c26df5ec67c8c2b71">Width</a>; x++)</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;                                    {</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                                        dataPointer += 3;</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                                        imageWriter.Write((*dataPointer).ToString(<span class="stringliteral">&quot;X2&quot;</span>));</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;                                        dataPointer++;</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;                                    }</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;                                }</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;                            }</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;                        }</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;                    }</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160; </div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;                    currObject = objectNum.ToString() + <span class="stringliteral">&quot; 0 obj\n&lt;&lt; /Type /XObject /Subtype /Image /Width &quot;</span> + image.<a class="code" href="class_vect_sharp_1_1_raster_image.html#a5c022bcd18b4e37c26df5ec67c8c2b71">Width</a>.ToString() + <span class="stringliteral">&quot; /Height &quot;</span> + image.<a class="code" href="class_vect_sharp_1_1_raster_image.html#a7fdcc792321aae93369d85c280bf696c">Height</a>.ToString() + <span class="stringliteral">&quot; /ColorSpace /DeviceGray /BitsPerComponent 8 /Interpolate &quot;</span> + (image.<a class="code" href="class_vect_sharp_1_1_raster_image.html#a5a5e8f5228b8aa3aa103693265fa900e">Interpolate</a> ? <span class="stringliteral">&quot;true&quot;</span> : <span class="stringliteral">&quot;false&quot;</span>) + <span class="stringliteral">&quot; /Filter &quot;</span> + filter + <span class="stringliteral">&quot; /Length &quot;</span> + alphaStream.Length + <span class="stringliteral">&quot; &gt;&gt;\nstream\n&quot;</span>;</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160; </div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;                    sw.Write(currObject);</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;                    position += currObject.Length;</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;                    sw.Flush();</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160; </div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;                    alphaStream.Seek(0, SeekOrigin.Begin);</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;                    alphaStream.CopyTo(stream);</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;                    position += alphaStream.Length;</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160; </div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                    currObject = <span class="stringliteral">&quot;\nendstream\nendobj\n&quot;</span>;</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;                    sw.Write(currObject);</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;                    position += currObject.Length;</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;                    objectNum++;</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160; </div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;                    alphaStream.Dispose();</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160; </div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;                }</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160; </div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;                objectPositions.Add(position);</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;                <span class="keywordtype">int</span> imageObjectNum = objectNum;</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160; </div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                filter = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;                MemoryStream imageStream = <span class="keyword">new</span> MemoryStream();</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160; </div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;                unsafe</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;                {</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;                    <span class="keywordtype">byte</span>* dataPointer = (<span class="keywordtype">byte</span>*)image.<a class="code" href="class_vect_sharp_1_1_raster_image.html#aaa0c2c00b3f570797d0eb31ea899dae2">ImageDataAddress</a>;</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160; </div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;                    if (compressStreams)</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;                    {</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;                        filter = <span class="stringliteral">&quot;/FlateDecode&quot;</span>;</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160; </div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;                        <span class="keywordflow">if</span> (image.<a class="code" href="class_vect_sharp_1_1_raster_image.html#a3012ff06029d327b3a280260fb2207f2">HasAlpha</a>)</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;                        {</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;                            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> y = 0; y &lt; image.<a class="code" href="class_vect_sharp_1_1_raster_image.html#a7fdcc792321aae93369d85c280bf696c">Height</a>; y++)</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                            {</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;                                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x = 0; x &lt; image.<a class="code" href="class_vect_sharp_1_1_raster_image.html#a5c022bcd18b4e37c26df5ec67c8c2b71">Width</a>; x++)</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;                                {</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;                                    imageStream.WriteByte(*dataPointer);</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;                                    dataPointer++;</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;                                    imageStream.WriteByte(*dataPointer);</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;                                    dataPointer++;</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;                                    imageStream.WriteByte(*dataPointer);</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;                                    dataPointer++;</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;                                    dataPointer++;</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;                                }</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                            }</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;                        }</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;                        {</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;                            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> y = 0; y &lt; image.<a class="code" href="class_vect_sharp_1_1_raster_image.html#a7fdcc792321aae93369d85c280bf696c">Height</a>; y++)</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;                            {</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;                                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x = 0; x &lt; image.<a class="code" href="class_vect_sharp_1_1_raster_image.html#a5c022bcd18b4e37c26df5ec67c8c2b71">Width</a>; x++)</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;                                {</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;                                    imageStream.WriteByte(*dataPointer);</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;                                    dataPointer++;</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;                                    imageStream.WriteByte(*dataPointer);</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;                                    dataPointer++;</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;                                    imageStream.WriteByte(*dataPointer);</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;                                    dataPointer++;</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;                                }</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;                            }</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;                        }</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160; </div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;                        imageStream.Seek(0, SeekOrigin.Begin);</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                        MemoryStream compressed = ZLibCompress(imageStream);</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;                        imageStream.Dispose();</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;                        imageStream = compressed;</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;                    }</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;                    {</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;                        filter = <span class="stringliteral">&quot;/ASCIIHexDecode&quot;</span>;</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160; </div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;                        <span class="keyword">using</span> (StreamWriter imageWriter = <span class="keyword">new</span> StreamWriter(imageStream, Encoding.ASCII, 1024, <span class="keyword">true</span>))</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;                        {</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                            <span class="keywordflow">if</span> (image.<a class="code" href="class_vect_sharp_1_1_raster_image.html#a3012ff06029d327b3a280260fb2207f2">HasAlpha</a>)</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                            {</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;                                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> y = 0; y &lt; image.<a class="code" href="class_vect_sharp_1_1_raster_image.html#a7fdcc792321aae93369d85c280bf696c">Height</a>; y++)</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;                                {</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;                                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x = 0; x &lt; image.<a class="code" href="class_vect_sharp_1_1_raster_image.html#a5c022bcd18b4e37c26df5ec67c8c2b71">Width</a>; x++)</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;                                    {</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;                                        imageWriter.Write((*dataPointer).ToString(<span class="stringliteral">&quot;X2&quot;</span>));</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;                                        dataPointer++;</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                                        imageWriter.Write((*dataPointer).ToString(<span class="stringliteral">&quot;X2&quot;</span>));</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;                                        dataPointer++;</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                                        imageWriter.Write((*dataPointer).ToString(<span class="stringliteral">&quot;X2&quot;</span>));</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;                                        dataPointer++;</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;                                        dataPointer++;</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;                                    }</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                                }</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;                            }</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;                            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;                            {</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;                                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> y = 0; y &lt; image.<a class="code" href="class_vect_sharp_1_1_raster_image.html#a7fdcc792321aae93369d85c280bf696c">Height</a>; y++)</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;                                {</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;                                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x = 0; x &lt; image.<a class="code" href="class_vect_sharp_1_1_raster_image.html#a5c022bcd18b4e37c26df5ec67c8c2b71">Width</a>; x++)</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;                                    {</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;                                        imageWriter.Write((*dataPointer).ToString(<span class="stringliteral">&quot;X2&quot;</span>));</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;                                        dataPointer++;</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;                                        imageWriter.Write((*dataPointer).ToString(<span class="stringliteral">&quot;X2&quot;</span>));</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;                                        dataPointer++;</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;                                        imageWriter.Write((*dataPointer).ToString(<span class="stringliteral">&quot;X2&quot;</span>));</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;                                        dataPointer++;</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;                                    }</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;                                }</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                            }</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                        }</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;                    }</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;                }</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160; </div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;                currObject = objectNum.ToString() + <span class="stringliteral">&quot; 0 obj\n&lt;&lt; /Type /XObject /Subtype /Image /Width &quot;</span> + image.<a class="code" href="class_vect_sharp_1_1_raster_image.html#a5c022bcd18b4e37c26df5ec67c8c2b71">Width</a>.ToString() + <span class="stringliteral">&quot; /Height &quot;</span> + image.<a class="code" href="class_vect_sharp_1_1_raster_image.html#a7fdcc792321aae93369d85c280bf696c">Height</a>.ToString() + <span class="stringliteral">&quot; /ColorSpace /DeviceRGB /BitsPerComponent 8 /Interpolate &quot;</span> + (image.<a class="code" href="class_vect_sharp_1_1_raster_image.html#a5a5e8f5228b8aa3aa103693265fa900e">Interpolate</a> ? <span class="stringliteral">&quot;true&quot;</span> : <span class="stringliteral">&quot;false&quot;</span>) + <span class="stringliteral">&quot; /Filter &quot;</span> + filter + <span class="stringliteral">&quot; /Length &quot;</span> + imageStream.Length + (image.<a class="code" href="class_vect_sharp_1_1_raster_image.html#a3012ff06029d327b3a280260fb2207f2">HasAlpha</a> ? <span class="stringliteral">&quot; /SMask &quot;</span> + (objectNum - 1) + <span class="stringliteral">&quot; 0 R&quot;</span> : <span class="stringliteral">&quot;&quot;</span>) + <span class="stringliteral">&quot; &gt;&gt;\nstream\n&quot;</span>;</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160; </div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;                sw.Write(currObject);</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;                position += currObject.Length;</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;                sw.Flush();</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160; </div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;                imageStream.Seek(0, SeekOrigin.Begin);</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;                imageStream.CopyTo(stream);</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;                position += imageStream.Length;</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160; </div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;                currObject = <span class="stringliteral">&quot;\nendstream\nendobj\n&quot;</span>;</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;                sw.Write(currObject);</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;                position += currObject.Length;</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;                objectNum++;</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160; </div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;                imageStream.Dispose();</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160; </div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;                imageObjectNums.Add(img.Key, imageObjectNum);</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;            }</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160; </div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;            <span class="keywordflow">if</span> (allFontFamilies.Count &gt; 0)</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;            {</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160; </div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;                <span class="comment">//Fonts</span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;                objectPositions.Add(position);</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;                <span class="keywordtype">int</span> fontListObject = objectNum;</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;                currObject = objectNum.ToString() + <span class="stringliteral">&quot; 0 obj\n&lt;&lt; &quot;</span>;</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;                <span class="keywordflow">foreach</span> (KeyValuePair&lt;string, string&gt; kvp <span class="keywordflow">in</span> nonSymbolFontIDs)</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;                {</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;                    currObject += <span class="stringliteral">&quot;/&quot;</span> + kvp.Value + <span class="stringliteral">&quot; &quot;</span> + fontObjectNums[<span class="stringliteral">&quot;nonsymbol: &quot;</span> + kvp.Key].ToString() + <span class="stringliteral">&quot; 0 R &quot;</span>;</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;                }</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;                <span class="keywordflow">foreach</span> (KeyValuePair&lt;string, string&gt; kvp <span class="keywordflow">in</span> symbolFontIDs)</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;                {</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;                    currObject += <span class="stringliteral">&quot;/&quot;</span> + kvp.Value + <span class="stringliteral">&quot; &quot;</span> + fontObjectNums[<span class="stringliteral">&quot;symbol: &quot;</span> + kvp.Key].ToString() + <span class="stringliteral">&quot; 0 R &quot;</span>;</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;                }</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;                currObject += <span class="stringliteral">&quot;&gt;&gt;\nendobj\n&quot;</span>;</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;                sw.Write(currObject);</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;                position += currObject.Length;</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;                objectNum++;</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160; </div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160; </div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;                <span class="comment">//Resources</span></div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                objectPositions.Add(position);</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;                resourceObject = objectNum;</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;                currObject = objectNum.ToString() + <span class="stringliteral">&quot; 0 obj\n&lt;&lt; /Font &quot;</span> + fontListObject.ToString() + <span class="stringliteral">&quot; 0 R&quot;</span>;</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160; </div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;                <span class="keywordflow">if</span> (alphas.Length &gt; 0)</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;                {</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;                    currObject += <span class="stringliteral">&quot; /ExtGState &lt;&lt;\n&quot;</span>;</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160; </div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; alphas.Length; i++)</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;                    {</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;                        currObject += <span class="stringliteral">&quot;/a&quot;</span> + i.ToString() + <span class="stringliteral">&quot; &lt;&lt; /CA &quot;</span> + alphas[i].ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; /ca &quot;</span> + alphas[i].ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; &gt;&gt;\n&quot;</span>;</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;                    }</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160; </div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;                    currObject += <span class="stringliteral">&quot;&gt;&gt;&quot;</span>;</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;                }</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160; </div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;                <span class="keywordflow">if</span> (imageObjectNums.Count &gt; 0)</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;                {</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;                    currObject += <span class="stringliteral">&quot; /XObject &lt;&lt;&quot;</span>;</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160; </div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;                    <span class="keywordflow">foreach</span> (KeyValuePair&lt;string, int&gt; kvp <span class="keywordflow">in</span> imageObjectNums)</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;                    {</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;                        currObject += <span class="stringliteral">&quot; /Img&quot;</span> + kvp.Value.ToString() + <span class="stringliteral">&quot; &quot;</span> + kvp.Value.ToString() + <span class="stringliteral">&quot; 0 R&quot;</span>;</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;                    }</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160; </div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;                    currObject += <span class="stringliteral">&quot; &gt;&gt;&quot;</span>;</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;                }</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160; </div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;                currObject += <span class="stringliteral">&quot; &gt;&gt;\nendobj\n&quot;</span>;</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;                sw.Write(currObject);</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;                position += currObject.Length;</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;                objectNum++;</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;            }</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;            {</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;                <span class="comment">//Resources</span></div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;                objectPositions.Add(position);</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;                resourceObject = objectNum;</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;                currObject = objectNum.ToString() + <span class="stringliteral">&quot; 0 obj\n&lt;&lt;&quot;</span>;</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160; </div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;                <span class="keywordflow">if</span> (alphas.Length &gt; 0)</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;                {</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;                    currObject += <span class="stringliteral">&quot; /ExtGState &lt;&lt;\n&quot;</span>;</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160; </div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; alphas.Length; i++)</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;                    {</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;                        currObject += <span class="stringliteral">&quot;/a&quot;</span> + i.ToString() + <span class="stringliteral">&quot; &lt;&lt; /CA &quot;</span> + alphas[i].ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; /ca &quot;</span> + alphas[i].ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; &gt;&gt;\n&quot;</span>;</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;                    }</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160; </div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;                    currObject += <span class="stringliteral">&quot;&gt;&gt;&quot;</span>;</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;                }</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160; </div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;                <span class="keywordflow">if</span> (imageObjectNums.Count &gt; 0)</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;                {</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;                    currObject += <span class="stringliteral">&quot; /XObject &lt;&lt;&quot;</span>;</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160; </div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;                    <span class="keywordflow">foreach</span> (KeyValuePair&lt;string, int&gt; kvp <span class="keywordflow">in</span> imageObjectNums)</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                    {</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;                        currObject += <span class="stringliteral">&quot; /Img&quot;</span> + kvp.Value.ToString() + <span class="stringliteral">&quot; &quot;</span> + kvp.Value.ToString() + <span class="stringliteral">&quot; 0 R&quot;</span>;</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;                    }</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160; </div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;                    currObject += <span class="stringliteral">&quot; &gt;&gt;&quot;</span>;</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;                }</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160; </div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;                currObject += <span class="stringliteral">&quot; &gt;&gt;\nendobj\n&quot;</span>;</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;                sw.Write(currObject);</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;                position += currObject.Length;</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;                objectNum++;</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;            }</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160; </div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;            <span class="keywordtype">int</span>[] pageContentInd = <span class="keyword">new</span> <span class="keywordtype">int</span>[document.Pages.Count];</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160; </div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160; </div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;            List&lt;(string, List&lt;(double, double, double, double)&gt;)&gt;[] taggedObjectRectsByPage = <span class="keyword">new</span> List&lt;(string, List&lt;(double, double, double, double)&gt;)&gt;[document.Pages.Count];</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;            Dictionary&lt;string, int&gt;[] taggedObjectRectsIndicesByPage = <span class="keyword">new</span> Dictionary&lt;string, int&gt;[document.Pages.Count];</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160; </div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> pageInd = 0; pageInd &lt; document.Pages.Count; pageInd++)</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;            {</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;                taggedObjectRectsByPage[pageInd] = <span class="keyword">new</span> List&lt;(string, List&lt;(double, double, double, double)&gt;)&gt;();</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;                taggedObjectRectsIndicesByPage[pageInd] = <span class="keyword">new</span> Dictionary&lt;string, int&gt;();</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160; </div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;                <span class="keywordtype">double</span>[,] transformationMatrix = <span class="keyword">new</span> <span class="keywordtype">double</span>[3, 3] { { 1, 0, 0 }, { 0, 1, 0 }, { 0, 0, 1 } };</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;                Stack&lt;double[,]&gt; savedStates = <span class="keyword">new</span> Stack&lt;double[,]&gt;();</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160; </div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;                MemoryStream contentStream = <span class="keyword">new</span> MemoryStream();</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160; </div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;                <span class="keyword">using</span> (StreamWriter ctW = <span class="keyword">new</span> StreamWriter(contentStream, Encoding.ASCII, 1024, <span class="keyword">true</span>))</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;                {</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; pageContexts[pageInd]._figures.Count; i++)</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;                    {</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;                        <span class="keywordtype">bool</span> isTransform = pageContexts[pageInd]._figures[i] is TransformFigure;</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160; </div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;                        <span class="keywordtype">bool</span> isClip = pageContexts[pageInd]._figures[i] is PathFigure pathFig &amp;&amp; pathFig.IsClipping;</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160; </div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;                        <span class="keywordflow">if</span> (!<span class="keywordtype">string</span>.IsNullOrEmpty(pageContexts[pageInd]._figures[i].Tag) &amp;&amp; !isTransform &amp;&amp; !isClip)</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;                        {</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;                            (double, double, double, double) boundingRect = MeasureFigure(pageContexts[pageInd]._figures[i], ref transformationMatrix, savedStates);</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160; </div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;                            <span class="keywordflow">if</span> (!taggedObjectRectsIndicesByPage[pageInd].TryGetValue(pageContexts[pageInd]._figures[i].Tag, out <span class="keywordtype">int</span> index))</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;                            {</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;                                taggedObjectRectsByPage[pageInd].Add((pageContexts[pageInd]._figures[i].Tag, <span class="keyword">new</span> List&lt;(<span class="keywordtype">double</span>, <span class="keywordtype">double</span>, <span class="keywordtype">double</span>, <span class="keywordtype">double</span>)&gt; { boundingRect }));</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;                                taggedObjectRectsIndicesByPage[pageInd][pageContexts[pageInd]._figures[i].Tag] = taggedObjectRectsByPage[pageInd].Count - 1;</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;                            }</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;                            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;                            {</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;                                (string, List&lt;(double, double, double, double)&gt;) previousRect = taggedObjectRectsByPage[pageInd][index];</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;                                taggedObjectRectsByPage[pageInd][index].Item2.Add(boundingRect);</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;                            }</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;                        }</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isTransform)</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;                        {</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;                            MeasureFigure(pageContexts[pageInd]._figures[i], ref transformationMatrix, savedStates);</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;                        }</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160; </div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;                        ctW.Write(FigureAsPDFString(pageContexts[pageInd]._figures[i], nonSymbolFontIDs, symbolFontIDs, symbolGlyphIndices, alphas, imageObjectNums));</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;                    }</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;                }</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160; </div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;                <span class="comment">//Contents</span></div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;                objectPositions.Add(position);</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;                contentStream.Seek(0, SeekOrigin.Begin);</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160; </div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;                MemoryStream compressedStream;</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160; </div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;                <span class="keywordflow">if</span> (!compressStreams)</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;                {</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;                    compressedStream = contentStream;</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;                }</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;                {</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;                    compressedStream = ZLibCompress(contentStream);</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;                }</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160; </div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;                <span class="keywordtype">long</span> streamLength = compressedStream.Length;</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160; </div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;                pageContentInd[pageInd] = objectNum;</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;                currObject = objectNum.ToString() + <span class="stringliteral">&quot; 0 obj\n&lt;&lt; /Length &quot;</span> + streamLength.ToString(System.Globalization.CultureInfo.InvariantCulture);</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160; </div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;                <span class="keywordflow">if</span> (compressStreams)</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;                {</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;                    currObject += <span class="stringliteral">&quot; /Filter [ /FlateDecode ]&quot;</span>;</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;                }</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160; </div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;                currObject += <span class="stringliteral">&quot; &gt;&gt;\nstream\n&quot;</span>;</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160; </div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;                sw.Write(currObject);</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;                sw.Flush();</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160; </div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;                position += currObject.Length;</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;                compressedStream.WriteTo(stream);</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;                position += streamLength;</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160; </div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;                compressedStream.Dispose();</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160; </div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;                currObject = <span class="stringliteral">&quot;endstream\nendobj\n&quot;</span>;</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;                sw.Write(currObject);</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;                position += currObject.Length;</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160; </div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;                objectNum++;</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;            }</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160; </div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;            <span class="comment">//Catalog</span></div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;            objectPositions.Add(position);</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;            <span class="keywordtype">int</span> rootObject = objectNum;</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;            currObject = objectNum.ToString() + <span class="stringliteral">&quot; 0 obj\n&lt;&lt; /Type /Catalog /Pages &quot;</span> + (objectNum + 1).ToString() + <span class="stringliteral">&quot; 0 R &gt;&gt;\nendobj\n&quot;</span>;</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;            sw.Write(currObject);</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;            position += currObject.Length;</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;            objectNum++;</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160; </div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;            objectPositions.Add(position);</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;            <span class="keywordtype">int</span> pageParent = objectNum;</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;            objectNum++;</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160; </div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;            List&lt;int&gt; pageObjectNums = <span class="keyword">new</span> List&lt;int&gt;();</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160; </div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;            <span class="comment">//We do not have enough information to resolve all relative links yet (we need the object number for all the pages).</span></div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;            List&lt;(<span class="keywordtype">int</span> annotationObjectNum, (double, double, double, double) annotationOrigin, <span class="keywordtype">int</span> annotationDestinationPage, (<span class="keywordtype">double</span>, <span class="keywordtype">double</span>, <span class="keywordtype">double</span>, <span class="keywordtype">double</span>) annotationDestination)&gt; postponedAnnotations = <span class="keyword">new</span> List&lt;(<span class="keywordtype">int</span>, (<span class="keywordtype">double</span>, <span class="keywordtype">double</span>, <span class="keywordtype">double</span>, <span class="keywordtype">double</span>), int, (double, double, double, double))&gt;();</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160; </div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;            <span class="comment">//Page</span></div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; document.Pages.Count; i++)</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;            {</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;                List&lt;int&gt; annotationsToInclude = <span class="keyword">new</span> List&lt;int&gt;();</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160; </div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;                <span class="comment">//Annotations</span></div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; taggedObjectRectsByPage[i].Count; j++)</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;                {</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;                    <span class="keywordflow">if</span> (linkDestinations.TryGetValue(taggedObjectRectsByPage[i][j].Item1, out <span class="keywordtype">string</span> destination))</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;                    {</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;                        <span class="keywordflow">if</span> (destination.StartsWith(<span class="stringliteral">&quot;#&quot;</span>))</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;                        {</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;                            <span class="comment">//Leave these for later, once we have computed the object number for all the pages. But we need to include the annotation number in the page, so we start processing the annotation now.</span></div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;                            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; taggedObjectRectsIndicesByPage.Length; k++)</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;                            {</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;                                <span class="keywordflow">if</span> (taggedObjectRectsIndicesByPage[k].TryGetValue(destination.Substring(1), out <span class="keywordtype">int</span> index))</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;                                {</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;                                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> l = 0; l &lt; taggedObjectRectsByPage[i][j].Item2.Count; l++)</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;                                    {</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;                                        objectPositions.Add(position);</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;                                        annotationsToInclude.Add(objectNum);</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;                                        postponedAnnotations.Add((objectNum, taggedObjectRectsByPage[i][j].Item2[l], k, taggedObjectRectsByPage[k][index].Item2[0]));</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;                                        objectNum++;</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;                                    }</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160; </div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;                                    <span class="comment">//Only consider the first match for the local destination.</span></div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;                                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;                                }</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;                            }</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;                        }</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;                        {</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;                            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> l = 0; l &lt; taggedObjectRectsByPage[i][j].Item2.Count; l++)</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;                            {</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;                                objectPositions.Add(position);</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;                                currObject = objectNum.ToString() + <span class="stringliteral">&quot; 0 obj\n&lt;&lt; /Type /Annot /Subtype /Link /Rect [&quot;</span> + taggedObjectRectsByPage[i][j].Item2[l].Item1.ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; &quot;</span> + taggedObjectRectsByPage[i][j].Item2[l].Item2.ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; &quot;</span> + taggedObjectRectsByPage[i][j].Item2[l].Item3.ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; &quot;</span> + taggedObjectRectsByPage[i][j].Item2[l].Item4.ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot;] &quot;</span> +</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;                                    <span class="stringliteral">&quot;/A &lt;&lt; /Type /Action /S /URI /URI (&quot;</span> + destination + <span class="stringliteral">&quot;) &gt;&gt; &gt;&gt;\nendobj\n&quot;</span>;</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;                                sw.Write(currObject);</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;                                annotationsToInclude.Add(objectNum);</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;                                objectNum++;</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;                                position += currObject.Length;</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;                            }</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;                        }</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;                    }</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;                }</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160; </div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;                <span class="comment">//Page</span></div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;                objectPositions.Add(position);</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;                currObject = objectNum.ToString() + <span class="stringliteral">&quot; 0 obj\n&lt;&lt; /Type /Page /Parent &quot;</span> + pageParent.ToString() + <span class="stringliteral">&quot; 0 R /MediaBox [0 0 &quot;</span> + document.Pages[i].Width.ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; &quot;</span> + document.Pages[i].Height.ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot;] /Resources &quot;</span> + resourceObject.ToString() + <span class="stringliteral">&quot; 0 R /Contents &quot;</span> + pageContentInd[i].ToString() + <span class="stringliteral">&quot; 0 R &quot;</span>;</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160; </div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;                <span class="keywordflow">if</span> (annotationsToInclude.Count &gt; 0)</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;                {</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;                    StringBuilder annotations = <span class="keyword">new</span> StringBuilder();</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;                    annotations.Append(<span class="stringliteral">&quot;/Annots [ &quot;</span>);</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; annotationsToInclude.Count; j++)</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;                    {</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;                        annotations.Append(annotationsToInclude[j].ToString() + <span class="stringliteral">&quot; 0 R &quot;</span>);</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;                    }</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;                    annotations.Append(<span class="stringliteral">&quot;] &quot;</span>);</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;                    currObject += annotations.ToString();</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;                }</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160; </div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;                currObject += <span class="stringliteral">&quot;&gt;&gt;\nendobj\n&quot;</span>;</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160; </div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;                sw.Write(currObject);</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;                pageObjectNums.Add(objectNum);</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;                objectNum++;</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;                position += currObject.Length;</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;            }</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160; </div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;            <span class="comment">//Now we have enough information for the postponed annotations.</span></div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;            <span class="keywordflow">foreach</span> ((<span class="keywordtype">int</span> annotationObjectNum, (<span class="keywordtype">double</span>, <span class="keywordtype">double</span>, <span class="keywordtype">double</span>, <span class="keywordtype">double</span>) annotationOrigin, <span class="keywordtype">int</span> annotationDestinationPage, (<span class="keywordtype">double</span>, <span class="keywordtype">double</span>, <span class="keywordtype">double</span>, <span class="keywordtype">double</span>) annotationDestination) in postponedAnnotations)</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;            {</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;                objectPositions[annotationObjectNum - 1] = position;</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;                currObject = annotationObjectNum.ToString() + <span class="stringliteral">&quot; 0 obj\n&lt;&lt; /Type /Annot /Subtype /Link /Rect [&quot;</span> + annotationOrigin.Item1.ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; &quot;</span> + annotationOrigin.Item2.ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; &quot;</span> + annotationOrigin.Item3.ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; &quot;</span> + annotationOrigin.Item4.ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot;] &quot;</span> +</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;                    <span class="stringliteral">&quot;/Dest [ &quot;</span> + pageObjectNums[annotationDestinationPage].ToString() + <span class="stringliteral">&quot; 0 R /XYZ &quot;</span> + annotationDestination.Item1.ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; &quot;</span> + annotationDestination.Item4.ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; 0 ] &gt;&gt;\nendobj\n&quot;</span>;</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;                sw.Write(currObject);</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;                position += currObject.Length;</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;            }</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160; </div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;            <span class="comment">//Pages</span></div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;            objectPositions[pageParent - 1] = position;</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;            currObject = pageParent.ToString() + <span class="stringliteral">&quot; 0 obj\n&lt;&lt; /Type /Pages /Kids [ &quot;</span>;</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; document.Pages.Count; i++)</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;            {</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;                <span class="comment">//currObject += (pageParent + i + 1).ToString() + &quot; 0 R &quot;;</span></div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;                currObject += pageObjectNums[i].ToString() + <span class="stringliteral">&quot; 0 R &quot;</span>;</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;            }</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;            currObject += <span class="stringliteral">&quot;] /Count &quot;</span> + document.Pages.Count + <span class="stringliteral">&quot; &gt;&gt;\nendobj\n\n&quot;</span>;</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;            sw.Write(currObject);</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;            position += currObject.Length;</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160; </div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;            <span class="comment">//XRef</span></div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;            sw.Write(<span class="stringliteral">&quot;xref\n0 &quot;</span> + (objectPositions.Count + 1).ToString() + <span class="stringliteral">&quot;\n0000000000 65535 f \n&quot;</span>);</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; objectPositions.Count; i++)</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;            {</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;                sw.Write(objectPositions[i].ToString(<span class="stringliteral">&quot;0000000000&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; 00000 n \n&quot;</span>);</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;            }</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160; </div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;            <span class="comment">//Trailer</span></div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;            sw.Write(<span class="stringliteral">&quot;trailer\n&lt;&lt; /Size &quot;</span> + (objectPositions.Count + 1).ToString() + <span class="stringliteral">&quot; /Root &quot;</span> + rootObject.ToString() + <span class="stringliteral">&quot; 0 R &gt;&gt;\nstartxref\n&quot;</span> + position.ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot;\n%%EOF\n&quot;</span>);</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160; </div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;            sw.Flush();</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;            sw.Dispose();</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;        }</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160; </div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;        <span class="keyword">private</span> <span class="keyword">static</span> (double, double, double, double) MeasureFigure(IFigure figure, ref <span class="keywordtype">double</span>[,] transformationMatrix, Stack&lt;<span class="keywordtype">double</span>[,]&gt; savedStates)</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;        {</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;            <span class="keywordflow">if</span> (figure is PathFigure)</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;            {</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;                PathFigure fig = figure as PathFigure;</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160; </div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;                <span class="keywordtype">double</span> minX = <span class="keywordtype">double</span>.MaxValue;</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;                <span class="keywordtype">double</span> maxX = <span class="keywordtype">double</span>.MinValue;</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;                <span class="keywordtype">double</span> minY = <span class="keywordtype">double</span>.MaxValue;</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;                <span class="keywordtype">double</span> maxY = <span class="keywordtype">double</span>.MinValue;</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160; </div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; fig.Segments.Length; i++)</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;                {</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;                    <span class="keywordflow">switch</span> (fig.Segments[i].Type)</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;                    {</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;                        <span class="keywordflow">case</span> SegmentType.Move:</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;                            {</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;                                <a class="code" href="struct_vect_sharp_1_1_point.html">Point</a> pt = transformationMatrix.Multiply(fig.Segments[i].Point);</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;                                minX = Math.Min(minX, pt.<a class="code" href="struct_vect_sharp_1_1_point.html#a5ec116350a6220c1b0c5e7115fa24115">X</a>);</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;                                minY = Math.Min(minY, pt.<a class="code" href="struct_vect_sharp_1_1_point.html#ae56e39cc16440deee22e54e89024f044">Y</a>);</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;                                maxX = Math.Max(maxX, pt.<a class="code" href="struct_vect_sharp_1_1_point.html#a5ec116350a6220c1b0c5e7115fa24115">X</a>);</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;                                maxY = Math.Max(maxY, pt.<a class="code" href="struct_vect_sharp_1_1_point.html#ae56e39cc16440deee22e54e89024f044">Y</a>);</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;                            }</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;                        <span class="keywordflow">case</span> <a class="code" href="namespace_vect_sharp.html#ad82c158fff255cb1cbe8d51de61cb4e4">SegmentType</a>.Line:</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;                            {</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;                                <a class="code" href="struct_vect_sharp_1_1_point.html">Point</a> pt = transformationMatrix.Multiply(fig.Segments[i].Point);</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;                                minX = Math.Min(minX, pt.<a class="code" href="struct_vect_sharp_1_1_point.html#a5ec116350a6220c1b0c5e7115fa24115">X</a>);</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;                                minY = Math.Min(minY, pt.<a class="code" href="struct_vect_sharp_1_1_point.html#ae56e39cc16440deee22e54e89024f044">Y</a>);</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;                                maxX = Math.Max(maxX, pt.<a class="code" href="struct_vect_sharp_1_1_point.html#a5ec116350a6220c1b0c5e7115fa24115">X</a>);</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;                                maxY = Math.Max(maxY, pt.<a class="code" href="struct_vect_sharp_1_1_point.html#ae56e39cc16440deee22e54e89024f044">Y</a>);</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;                            }</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;                        <span class="keywordflow">case</span> SegmentType.CubicBezier:</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;                            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; fig.Segments[i].Points.Length; j++)</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;                            {</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;                                Point pt = transformationMatrix.Multiply(fig.Segments[i].Points[j]);</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;                                minX = Math.Min(minX, pt.X);</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;                                minY = Math.Min(minY, pt.Y);</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;                                maxX = Math.Max(maxX, pt.X);</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;                                maxY = Math.Max(maxY, pt.Y);</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;                            }</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;                        <span class="keywordflow">case</span> <a class="code" href="namespace_vect_sharp.html#ad82c158fff255cb1cbe8d51de61cb4e4">SegmentType</a>.Close:</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;                    }</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;                }</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160; </div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;                <span class="keywordflow">return</span> (minX, minY, maxX, maxY);</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;            }</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (figure is TextFigure)</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;            {</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;                TextFigure fig = figure as TextFigure;</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160; </div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;                <span class="keywordtype">double</span> realX = fig.Position.X;</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160; </div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;                <span class="keywordflow">if</span> (fig.Font.FontFamily.TrueTypeFile != <span class="keyword">null</span>)</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;                {</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;                    realX = fig.Position.X - fig.Font.FontFamily.TrueTypeFile.Get1000EmGlyphBearings(fig.Text[0]).LeftSideBearing * fig.Font.FontSize / 1000;</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;                }</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160; </div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;                <span class="keywordtype">double</span> yMax = 0;</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;                <span class="keywordtype">double</span> yMin = 0;</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160; </div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;                <span class="keywordflow">if</span> (fig.Font.FontFamily.TrueTypeFile != <span class="keyword">null</span>)</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;                {</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; fig.Text.Length; i++)</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;                    {</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;                        TrueTypeFile.VerticalMetrics vMet = fig.Font.FontFamily.TrueTypeFile.Get1000EmGlyphVerticalMetrics(fig.Text[i]);</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;                        yMin = Math.Min(yMin, vMet.YMin * fig.Font.FontSize / 1000);</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;                        yMax = Math.Max(yMax, vMet.YMax * fig.Font.FontSize / 1000);</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;                    }</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;                }</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160; </div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;                <span class="keywordtype">double</span> realY = fig.Position.Y;</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160; </div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;                <span class="keywordflow">if</span> (fig.TextBaseline == <a class="code" href="namespace_vect_sharp.html#acfad2994b272989b9cb471230d95334f">TextBaselines</a>.Bottom)</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;                {</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;                    realY -= yMax;</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;                }</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fig.TextBaseline == <a class="code" href="namespace_vect_sharp.html#acfad2994b272989b9cb471230d95334f">TextBaselines</a>.Top)</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;                {</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;                    realY -= yMin;</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;                }</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fig.TextBaseline == <a class="code" href="namespace_vect_sharp.html#acfad2994b272989b9cb471230d95334f">TextBaselines</a>.Middle)</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;                {</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;                    realY -= (yMax + yMin) * 0.5;</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;                }</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fig.TextBaseline == <a class="code" href="namespace_vect_sharp.html#acfad2994b272989b9cb471230d95334f">TextBaselines</a>.Baseline)</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;                {</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;                    realY -= yMax + yMin;</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;                }</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160; </div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;                Font.DetailedFontMetrics metrics = fig.Font.MeasureTextAdvanced(fig.Text);</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160; </div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;                Point corner1 = <span class="keyword">new</span> Point(fig.Position.X - metrics.LeftSideBearing, realY + metrics.Top);</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;                Point corner2 = <span class="keyword">new</span> Point(fig.Position.X + metrics.Width, realY + metrics.Top);</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;                Point corner3 = <span class="keyword">new</span> Point(fig.Position.X + metrics.Width, realY + metrics.Bottom);</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;                Point corner4 = <span class="keyword">new</span> Point(fig.Position.X - metrics.LeftSideBearing, realY + metrics.Bottom);</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160; </div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;                corner1 = transformationMatrix.Multiply(corner1);</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;                corner2 = transformationMatrix.Multiply(corner2);</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;                corner3 = transformationMatrix.Multiply(corner3);</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;                corner4 = transformationMatrix.Multiply(corner4);</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160; </div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;                <span class="keywordflow">return</span> (Math.Min(corner1.X, Math.Min(corner2.X, Math.Min(corner3.X, corner4.X))), Math.Min(corner1.Y, Math.Min(corner2.Y, Math.Min(corner3.Y, corner4.Y))), Math.Max(corner1.X, Math.Max(corner2.X, Math.Max(corner3.X, corner4.X))), Math.Max(corner1.Y, Math.Max(corner2.Y, Math.Max(corner3.Y, corner4.Y))));</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;            }</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (figure is TransformFigure transf)</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;            {</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;                <span class="keywordflow">if</span> (transf.TransformType == TransformFigure.TransformTypes.Transform)</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;                {</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;                    transformationMatrix = transformationMatrix.Multiply(transf.TransformationMatrix);</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;                }</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (transf.TransformType == TransformFigure.TransformTypes.Save)</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;                {</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;                    savedStates.Push(transformationMatrix);</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;                }</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (transf.TransformType == TransformFigure.TransformTypes.Restore)</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;                {</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;                    transformationMatrix = savedStates.Pop();</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;                }</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160; </div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;                <span class="keywordflow">return</span> (0, 0, 0, 0);</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;            }</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (figure is RasterImageFigure)</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;            {</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;                Point corner1 = <span class="keyword">new</span> Point(0, 0);</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;                Point corner2 = <span class="keyword">new</span> Point(0, 1);</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;                Point corner3 = <span class="keyword">new</span> Point(1, 1);</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;                Point corner4 = <span class="keyword">new</span> Point(1, 0);</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160; </div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;                corner1 = transformationMatrix.Multiply(corner1);</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;                corner2 = transformationMatrix.Multiply(corner2);</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;                corner3 = transformationMatrix.Multiply(corner3);</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;                corner4 = transformationMatrix.Multiply(corner4);</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160; </div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;                <span class="keywordflow">return</span> (Math.Min(corner1.X, Math.Min(corner2.X, Math.Min(corner3.X, corner4.X))), Math.Min(corner1.Y, Math.Min(corner2.Y, Math.Min(corner3.Y, corner4.Y))), Math.Max(corner1.X, Math.Max(corner2.X, Math.Max(corner3.X, corner4.X))), Math.Max(corner1.Y, Math.Max(corner2.Y, Math.Max(corner3.Y, corner4.Y))));</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;            }</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;            {</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;                <span class="keywordflow">return</span> (0, 0, 0, 0);</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;            }</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;        }</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160; </div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">double</span>[,] Multiply(<span class="keyword">this</span> <span class="keywordtype">double</span>[,] matrix, <span class="keywordtype">double</span>[,] matrix2)</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;        {</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;            <span class="keywordtype">double</span>[,] tbr = <span class="keyword">new</span> <span class="keywordtype">double</span>[3, 3];</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160; </div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;            tbr[0, 0] = matrix[0, 0] * matrix2[0, 0] - matrix[0, 1] * matrix2[1, 0] + matrix[0, 2] * matrix2[2, 0];</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;            tbr[0, 1] = -matrix[0, 0] * matrix2[0, 1] + matrix[0, 1] * matrix2[1, 1] + matrix[0, 2] * matrix2[2, 1];</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;            tbr[0, 2] = matrix[0, 0] * matrix2[0, 2] + matrix[0, 1] * matrix2[1, 2] + matrix[0, 2] * matrix2[2, 2];</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160; </div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;            tbr[1, 0] = matrix[1, 0] * matrix2[0, 0] - matrix[1, 1] * matrix2[1, 0] + matrix[1, 2] * matrix2[2, 0];</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;            tbr[1, 1] = -matrix[1, 0] * matrix2[0, 1] + matrix[1, 1] * matrix2[1, 1] + matrix[1, 2] * matrix2[2, 1];</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;            tbr[1, 2] = matrix[1, 0] * matrix2[0, 2] + matrix[1, 1] * matrix2[1, 2] + matrix[1, 2] * matrix2[2, 2];</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160; </div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;            tbr[2, 0] = matrix[2, 0] * matrix2[0, 0] - matrix[2, 1] * matrix2[1, 0] + matrix[2, 2] * matrix2[2, 0];</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;            tbr[2, 1] = -matrix[2, 0] * matrix2[0, 1] + matrix[2, 1] * matrix2[1, 1] + matrix[2, 2] * matrix2[2, 1];</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;            tbr[2, 2] = matrix[2, 0] * matrix2[0, 2] + matrix[2, 1] * matrix2[1, 2] + matrix[2, 2] * matrix2[2, 2];</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160; </div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;            <span class="keywordflow">return</span> tbr;</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;        }</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160; </div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;        <span class="keyword">private</span> <span class="keyword">static</span> Point Multiply(<span class="keyword">this</span> <span class="keywordtype">double</span>[,] matrix, Point point)</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;        {</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;            <span class="keywordtype">double</span>[] transPt = <span class="keyword">new</span> <span class="keywordtype">double</span>[3];</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160; </div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;            transPt[0] = matrix[0, 0] * point.X + matrix[0, 1] * point.Y + matrix[0, 2];</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;            transPt[1] = matrix[1, 0] * point.X + matrix[1, 1] * point.Y + matrix[1, 2];</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;            transPt[2] = matrix[2, 0] * point.X + matrix[2, 1] * point.Y + matrix[2, 2];</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160; </div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">new</span> Point(transPt[0] / transPt[2], transPt[1] / transPt[2]);</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;        }</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160; </div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">string</span> FigureAsPDFString(IFigure figure, Dictionary&lt;string, string&gt; nonSymbolFontIds, Dictionary&lt;string, string&gt; symbolFontIds, Dictionary&lt;<span class="keywordtype">string</span>, Dictionary&lt;char, int&gt;&gt; symbolGlyphIndices, <span class="keywordtype">double</span>[] alphas, Dictionary&lt;string, int&gt; imageObjectNums)</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;        {</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160; </div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;            StringBuilder sb = <span class="keyword">new</span> StringBuilder();</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160; </div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;            <span class="keywordflow">if</span> (figure.Fill != <span class="keyword">null</span>)</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;            {</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;                sb.Append(figure.Fill?.R.ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; &quot;</span> + figure.Fill?.G.ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; &quot;</span> + figure.Fill?.B.ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; rg\n&quot;</span>);</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;                sb.Append(<span class="stringliteral">&quot;/a&quot;</span> + Array.IndexOf(alphas, figure.Fill?.A).ToString() + <span class="stringliteral">&quot; gs\n&quot;</span>);</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;            }</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160; </div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;            <span class="keywordflow">if</span> (figure.Stroke != <span class="keyword">null</span>)</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;            {</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;                sb.Append(figure.Stroke?.R.ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; &quot;</span> + figure.Stroke?.G.ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; &quot;</span> + figure.Stroke?.B.ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; RG\n&quot;</span>);</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;                sb.Append(<span class="stringliteral">&quot;/a&quot;</span> + Array.IndexOf(alphas, figure.Stroke?.A).ToString() + <span class="stringliteral">&quot; gs\n&quot;</span>);</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;                sb.Append(figure.LineWidth.ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; w\n&quot;</span>);</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;                sb.Append(((<span class="keywordtype">int</span>)figure.LineCap).ToString() + <span class="stringliteral">&quot; J\n&quot;</span>);</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;                sb.Append(((<span class="keywordtype">int</span>)figure.LineJoin).ToString() + <span class="stringliteral">&quot; j\n&quot;</span>);</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;                <span class="keywordflow">if</span> (figure.LineDash.UnitsOff != 0 || figure.LineDash.UnitsOn != 0)</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;                {</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;                    sb.Append(<span class="stringliteral">&quot;[ &quot;</span> + figure.LineDash.UnitsOn.ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; &quot;</span> + figure.LineDash.UnitsOff.ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; ] &quot;</span> + figure.LineDash.Phase.ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; d\n&quot;</span>);</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;                }</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;                {</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;                    sb.Append(<span class="stringliteral">&quot;[] 0 d\n&quot;</span>);</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;                }</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;            }</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160; </div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;            <span class="keywordflow">if</span> (figure is PathFigure)</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;            {</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;                PathFigure fig = figure as PathFigure;</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160; </div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; fig.Segments.Length; i++)</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;                {</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;                    <span class="keywordflow">switch</span> (fig.Segments[i].Type)</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;                    {</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;                        <span class="keywordflow">case</span> <a class="code" href="namespace_vect_sharp.html#ad82c158fff255cb1cbe8d51de61cb4e4">SegmentType</a>.Move:</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;                            {</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;                                sb.Append(fig.Segments[i].Point.X.ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; &quot;</span> + fig.Segments[i].Point.Y.ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; m &quot;</span>);</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;                            }</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;                        <span class="keywordflow">case</span> <a class="code" href="namespace_vect_sharp.html#ad82c158fff255cb1cbe8d51de61cb4e4">SegmentType</a>.Line:</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;                            {</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;                                sb.Append(fig.Segments[i].Point.X.ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; &quot;</span> + fig.Segments[i].Point.Y.ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; l &quot;</span>);</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;                            }</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;                        <span class="keywordflow">case</span> <a class="code" href="namespace_vect_sharp.html#ad82c158fff255cb1cbe8d51de61cb4e4">SegmentType</a>.CubicBezier:</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;                            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; fig.Segments[i].Points.Length; j++)</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;                            {</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;                                sb.Append(fig.Segments[i].Points[j].X.ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; &quot;</span> + fig.Segments[i].Points[j].Y.ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; &quot;</span>);</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;                            }</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;                            sb.Append(<span class="stringliteral">&quot;c &quot;</span>);</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;                        <span class="keywordflow">case</span> <a class="code" href="namespace_vect_sharp.html#ad82c158fff255cb1cbe8d51de61cb4e4">SegmentType</a>.Close:</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;                            sb.Append(<span class="stringliteral">&quot;h &quot;</span>);</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;                    }</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;                }</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160; </div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;                <span class="keywordflow">if</span> (fig.IsClipping)</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;                {</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;                    sb.Append(<span class="stringliteral">&quot;W n\n&quot;</span>);</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;                }</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;                {</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;                    <span class="keywordflow">if</span> (fig.Fill != <span class="keyword">null</span>)</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;                    {</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;                        sb.Append(<span class="stringliteral">&quot;f*\n&quot;</span>);</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;                    }</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160; </div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;                    <span class="keywordflow">if</span> (fig.Stroke != <span class="keyword">null</span>)</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;                    {</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;                        sb.Append(<span class="stringliteral">&quot;S\n&quot;</span>);</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;                    }</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;                }</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;            }</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (figure is TextFigure)</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;            {</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;                TextFigure fig = figure as TextFigure;</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160; </div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;                List&lt;(<span class="keywordtype">string</span> txt, <span class="keywordtype">bool</span> isSymbolic)&gt; segments = <span class="keyword">new</span> List&lt;(<span class="keywordtype">string</span> txt, <span class="keywordtype">bool</span> isSymbolic)&gt;();</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160; </div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;                StringBuilder currSeg = <span class="keyword">new</span> StringBuilder();</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;                <span class="keywordtype">bool</span> currSymbolic = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160; </div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; fig.Text.Length; i++)</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;                {</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;                    <span class="keywordflow">if</span> (CP1252Chars.Contains(fig.Text[i]))</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;                    {</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;                        <span class="keywordflow">if</span> (!currSymbolic)</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;                        {</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;                            currSeg.Append(fig.Text[i]);</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;                        }</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;                        {</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;                            <span class="keywordflow">if</span> (currSeg.Length &gt; 0)</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;                            {</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;                                segments.Add((currSeg.ToString(), currSymbolic));</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;                            }</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160; </div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;                            currSeg = <span class="keyword">new</span> StringBuilder();</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;                            currSymbolic = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;                            currSeg.Append(fig.Text[i]);</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;                        }</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;                    }</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;                    {</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;                        <span class="keywordflow">if</span> (currSymbolic)</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;                        {</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;                            currSeg.Append(fig.Text[i]);</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;                        }</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;                        {</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;                            <span class="keywordflow">if</span> (currSeg.Length &gt; 0)</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;                            {</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;                                segments.Add((currSeg.ToString(), currSymbolic));</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;                            }</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160; </div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;                            currSeg = <span class="keyword">new</span> StringBuilder();</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;                            currSymbolic = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;                            currSeg.Append(fig.Text[i]);</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;                        }</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;                    }</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;                }</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160; </div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;                <span class="keywordflow">if</span> (currSeg.Length &gt; 0)</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;                {</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;                    segments.Add((currSeg.ToString(), currSymbolic));</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;                }</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160; </div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160; </div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160; </div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;                <span class="keywordtype">double</span> realX = fig.Position.X;</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160; </div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;                <span class="keywordflow">if</span> (fig.Font.FontFamily.TrueTypeFile != <span class="keyword">null</span>)</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;                {</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;                    realX = fig.Position.X - fig.Font.FontFamily.TrueTypeFile.Get1000EmGlyphBearings(fig.Text[0]).LeftSideBearing * fig.Font.FontSize / 1000;</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;                }</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160; </div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;                <span class="keywordtype">double</span> yMax = 0;</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;                <span class="keywordtype">double</span> yMin = 0;</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160; </div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;                <span class="keywordflow">if</span> (fig.Font.FontFamily.TrueTypeFile != <span class="keyword">null</span>)</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;                {</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; fig.Text.Length; i++)</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;                    {</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;                        TrueTypeFile.VerticalMetrics vMet = fig.Font.FontFamily.TrueTypeFile.Get1000EmGlyphVerticalMetrics(fig.Text[i]);</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;                        yMin = Math.Min(yMin, vMet.YMin * fig.Font.FontSize / 1000);</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;                        yMax = Math.Max(yMax, vMet.YMax * fig.Font.FontSize / 1000);</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;                    }</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;                }</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160; </div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;                <span class="keywordtype">double</span> realY = fig.Position.Y;</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160; </div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;                <span class="keywordflow">if</span> (fig.TextBaseline == <a class="code" href="namespace_vect_sharp.html#acfad2994b272989b9cb471230d95334f">TextBaselines</a>.Bottom)</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;                {</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;                    realY -= yMax;</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;                }</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fig.TextBaseline == <a class="code" href="namespace_vect_sharp.html#acfad2994b272989b9cb471230d95334f">TextBaselines</a>.Top)</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;                {</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;                    realY -= yMin;</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;                }</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fig.TextBaseline == <a class="code" href="namespace_vect_sharp.html#acfad2994b272989b9cb471230d95334f">TextBaselines</a>.Middle)</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;                {</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;                    realY -= (yMax + yMin) * 0.5;</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;                }</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fig.TextBaseline == <a class="code" href="namespace_vect_sharp.html#acfad2994b272989b9cb471230d95334f">TextBaselines</a>.Baseline)</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;                {</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;                    realY -= yMax + yMin;</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;                }</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160; </div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;                <span class="keywordtype">double</span> middleY = realY + (yMax + yMin) * 0.5;</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160; </div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160; </div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160; </div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;                sb.Append(<span class="stringliteral">&quot;q\n1 0 0 1 0 &quot;</span> + (middleY).ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; cm\n&quot;</span>);</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;                sb.Append(<span class="stringliteral">&quot;1 0 0 -1 0 0 cm\n&quot;</span>);</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;                sb.Append(<span class="stringliteral">&quot;1 0 0 1 0 &quot;</span> + (-middleY).ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; cm\n&quot;</span>);</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160; </div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;                sb.Append(<span class="stringliteral">&quot;BT\n&quot;</span>);</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160; </div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;                <span class="keywordflow">if</span> (figure.Stroke != <span class="keyword">null</span> &amp;&amp; figure.Fill != <span class="keyword">null</span>)</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;                {</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;                    sb.Append(<span class="stringliteral">&quot;2 Tr\n&quot;</span>);</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;                }</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (figure.Stroke != <span class="keyword">null</span>)</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;                {</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;                    sb.Append(<span class="stringliteral">&quot;1 Tr\n&quot;</span>);</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;                }</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (figure.Fill != <span class="keyword">null</span>)</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;                {</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;                    sb.Append(<span class="stringliteral">&quot;0 Tr\n&quot;</span>);</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;                }</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160; </div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;                sb.Append(realX.ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; &quot;</span> + realY.ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; Td\n&quot;</span>);</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160; </div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; segments.Count; i++)</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;                {</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;                    <span class="keywordflow">if</span> (!segments[i].isSymbolic)</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;                    {</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;                        sb.Append(<span class="stringliteral">&quot;/&quot;</span> + nonSymbolFontIds[fig.Font.FontFamily.FileName] + <span class="stringliteral">&quot; &quot;</span> + fig.Font.FontSize.ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; Tf\n&quot;</span>);</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;                        sb.Append(<span class="stringliteral">&quot;(&quot;</span> + EscapeStringForPDF(segments[i].txt) + <span class="stringliteral">&quot;) Tj\n&quot;</span>);</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;                    }</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;                    {</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;                        sb.Append(<span class="stringliteral">&quot;/&quot;</span> + symbolFontIds[fig.Font.FontFamily.FileName] + <span class="stringliteral">&quot; &quot;</span> + fig.Font.FontSize.ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; Tf\n&quot;</span>);</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;                        sb.Append(<span class="stringliteral">&quot;&lt;&quot;</span> + EscapeSymbolStringForPDF(segments[i].txt, symbolGlyphIndices[fig.Font.FontFamily.FileName]) + <span class="stringliteral">&quot;&gt; Tj\n&quot;</span>);</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;                    }</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;                }</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160; </div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;                sb.Append(<span class="stringliteral">&quot;ET\nQ\n&quot;</span>);</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;            }</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (figure is TransformFigure transf)</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;            {</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;                <span class="keywordflow">if</span> (transf.TransformType == TransformFigure.TransformTypes.Transform)</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;                {</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;                    sb.Append(transf.TransformationMatrix[0, 0].ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; &quot;</span>);</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;                    sb.Append(transf.TransformationMatrix[0, 1].ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; &quot;</span>);</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;                    sb.Append(transf.TransformationMatrix[1, 0].ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; &quot;</span>);</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;                    sb.Append(transf.TransformationMatrix[1, 1].ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; &quot;</span>);</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;                    sb.Append(transf.TransformationMatrix[0, 2].ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; &quot;</span>);</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;                    sb.Append(transf.TransformationMatrix[1, 2].ToString(<span class="stringliteral">&quot;0.################&quot;</span>, System.Globalization.CultureInfo.InvariantCulture) + <span class="stringliteral">&quot; cm\n&quot;</span>);</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;                }</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (transf.TransformType == TransformFigure.TransformTypes.Save)</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;                {</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;                    sb.Append(<span class="stringliteral">&quot;q\n&quot;</span>);</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;                }</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (transf.TransformType == TransformFigure.TransformTypes.Restore)</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;                {</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;                    sb.Append(<span class="stringliteral">&quot;Q\n&quot;</span>);</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;                }</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;            }</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (figure is RasterImageFigure fig)</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;            {</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;                sb.Append(<span class="stringliteral">&quot;/a&quot;</span> + Array.IndexOf(alphas, 1).ToString() + <span class="stringliteral">&quot; gs\n&quot;</span>);</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160; </div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;                <span class="keywordtype">int</span> imageNum = imageObjectNums[fig.Image.Id];</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160; </div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;                sb.Append(<span class="stringliteral">&quot;/Img&quot;</span> + imageNum.ToString() + <span class="stringliteral">&quot; Do\n&quot;</span>);</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;            }</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160; </div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;            <span class="keywordflow">return</span> sb.ToString();</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;        }</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160; </div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;        <span class="keyword">internal</span> <span class="keyword">static</span> MemoryStream ZLibCompress(Stream contentStream)</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;        {</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;            MemoryStream compressedStream = <span class="keyword">new</span> MemoryStream();</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;            compressedStream.Write(<span class="keyword">new</span> <span class="keywordtype">byte</span>[] { 0x78, 0x01 }, 0, 2);</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160; </div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;            <span class="keyword">using</span> (DeflateStream deflate = <span class="keyword">new</span> DeflateStream(compressedStream, CompressionLevel.Optimal, <span class="keyword">true</span>))</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;            {</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;                contentStream.CopyTo(deflate);</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;            }</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;            contentStream.Seek(0, SeekOrigin.Begin);</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160; </div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;            uint checksum = Adler32(contentStream);</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160; </div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;            compressedStream.Write(<span class="keyword">new</span> <span class="keywordtype">byte</span>[] { (byte)((checksum &gt;&gt; 24) &amp; 255), (byte)((checksum &gt;&gt; 16) &amp; 255), (<span class="keywordtype">byte</span>)((checksum &gt;&gt; 8) &amp; 255), (byte)(checksum &amp; 255) }, 0, 4);</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160; </div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;            compressedStream.Seek(0, SeekOrigin.Begin);</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160; </div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;            <span class="keywordflow">return</span> compressedStream;</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;        }</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160; </div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;        <span class="keyword">internal</span> <span class="keyword">static</span> uint Adler32(Stream contentStream)</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;        {</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;            uint s1 = 1;</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;            uint s2 = 0;</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160; </div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;            <span class="keywordtype">int</span> readByte;</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160; </div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;            <span class="keywordflow">while</span> ((readByte = contentStream.ReadByte()) &gt;= 0)</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;            {</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;                s1 = (s1 + (byte)readByte) % 65521U;</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;                s2 = (s2 + s1) % 65521U;</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;            }</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160; </div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;            <span class="keywordflow">return</span> (s2 &lt;&lt; 16) + s1;</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;        }</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;    }</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="aclass_vect_sharp_1_1_true_type_file_html"><div class="ttname"><a href="class_vect_sharp_1_1_true_type_file.html">VectSharp.TrueTypeFile</a></div><div class="ttdoc">Represents a font file in TrueType format. Reference: http://stevehanov.ca/blog/?id=143,...</div><div class="ttdef"><b>Definition:</b> <a href="_true_type_8cs_source.html#l00030">TrueType.cs:31</a></div></div>
<div class="ttc" id="astruct_vect_sharp_1_1_colour_html"><div class="ttname"><a href="struct_vect_sharp_1_1_colour.html">VectSharp.Colour</a></div><div class="ttdoc">Represents an RGB colour.</div><div class="ttdef"><b>Definition:</b> <a href="_graphics_8cs_source.html#l00169">Graphics.cs:170</a></div></div>
<div class="ttc" id="aclass_vect_sharp_1_1_true_type_file_html_a007e5a47fcd0eeac25a2d40e1e87a6a7"><div class="ttname"><a href="class_vect_sharp_1_1_true_type_file.html#a007e5a47fcd0eeac25a2d40e1e87a6a7">VectSharp.TrueTypeFile.Get1000EmYMax</a></div><div class="ttdeci">double Get1000EmYMax()</div><div class="ttdoc">Computes the maximum height over the baseline of the font, in thousandths of em unit.</div><div class="ttdef"><b>Definition:</b> <a href="_true_type_8cs_source.html#l02080">TrueType.cs:2080</a></div></div>
<div class="ttc" id="aclass_vect_sharp_1_1_raster_image_html"><div class="ttname"><a href="class_vect_sharp_1_1_raster_image.html">VectSharp.RasterImage</a></div><div class="ttdoc">Represents a raster image, created from raw pixel data. Consider using the derived classes included i...</div><div class="ttdef"><b>Definition:</b> <a href="_raster_image_8cs_source.html#l00098">RasterImage.cs:99</a></div></div>
<div class="ttc" id="aclass_vect_sharp_1_1_graphics_path_html"><div class="ttname"><a href="class_vect_sharp_1_1_graphics_path.html">VectSharp.GraphicsPath</a></div><div class="ttdoc">Represents a graphics path that can be filled or stroked.</div><div class="ttdef"><b>Definition:</b> <a href="_graphics_8cs_source.html#l03583">Graphics.cs:3584</a></div></div>
<div class="ttc" id="anamespace_vect_sharp_html"><div class="ttname"><a href="namespace_vect_sharp.html">VectSharp</a></div><div class="ttdef"><b>Definition:</b> <a href="_document_8cs_source.html#l00022">Document.cs:23</a></div></div>
<div class="ttc" id="aclass_vect_sharp_1_1_true_type_file_html_a9c43d885920fab37a9314aa390453bc3"><div class="ttname"><a href="class_vect_sharp_1_1_true_type_file.html#a9c43d885920fab37a9314aa390453bc3">VectSharp.TrueTypeFile.GetGlyphIndex</a></div><div class="ttdeci">int GetGlyphIndex(char glyph)</div><div class="ttdoc">Determines the index of the glyph corresponding to a certain character.</div><div class="ttdef"><b>Definition:</b> <a href="_true_type_8cs_source.html#l01960">TrueType.cs:1960</a></div></div>
<div class="ttc" id="aclass_vect_sharp_1_1_document_html"><div class="ttname"><a href="class_vect_sharp_1_1_document.html">VectSharp.Document</a></div><div class="ttdoc">Represents a collection of pages.</div><div class="ttdef"><b>Definition:</b> <a href="_document_8cs_source.html#l00027">Document.cs:28</a></div></div>
<div class="ttc" id="aclass_vect_sharp_1_1_raster_image_html_a5c022bcd18b4e37c26df5ec67c8c2b71"><div class="ttname"><a href="class_vect_sharp_1_1_raster_image.html#a5c022bcd18b4e37c26df5ec67c8c2b71">VectSharp.RasterImage.Width</a></div><div class="ttdeci">int Width</div><div class="ttdoc">The width in pixels of the image.</div><div class="ttdef"><b>Definition:</b> <a href="_raster_image_8cs_source.html#l00123">RasterImage.cs:123</a></div></div>
<div class="ttc" id="anamespace_vect_sharp_html_ad82c158fff255cb1cbe8d51de61cb4e4ad3d2e617335f08df83599665eef8a418"><div class="ttname"><a href="namespace_vect_sharp.html#ad82c158fff255cb1cbe8d51de61cb4e4ad3d2e617335f08df83599665eef8a418">VectSharp.SegmentType.Close</a></div><div class="ttdeci">@ Close</div><div class="ttdoc">The segment represents the closing segment of a figure.</div></div>
<div class="ttc" id="aclass_vect_sharp_1_1_true_type_file_html_a5cbc0138ead9fd519e09e8f1988c7117"><div class="ttname"><a href="class_vect_sharp_1_1_true_type_file.html#a5cbc0138ead9fd519e09e8f1988c7117">VectSharp.TrueTypeFile.IsFixedPitch</a></div><div class="ttdeci">bool IsFixedPitch()</div><div class="ttdoc">Determines whether the typeface is fixed-pitch (aka monospaces) or not.</div><div class="ttdef"><b>Definition:</b> <a href="_true_type_8cs_source.html#l01926">TrueType.cs:1926</a></div></div>
<div class="ttc" id="anamespace_vect_sharp_html_a6bde58d6aab37ea51e32240503678209"><div class="ttname"><a href="namespace_vect_sharp.html#a6bde58d6aab37ea51e32240503678209">VectSharp.LineCaps</a></div><div class="ttdeci">LineCaps</div><div class="ttdoc">Represents line caps.</div><div class="ttdef"><b>Definition:</b> <a href="_graphics_8cs_source.html#l00088">Graphics.cs:89</a></div></div>
<div class="ttc" id="aclass_vect_sharp_1_1_true_type_file_html_a8eacb1aad853f9938824a90c43dd4171"><div class="ttname"><a href="class_vect_sharp_1_1_true_type_file.html#a8eacb1aad853f9938824a90c43dd4171">VectSharp.TrueTypeFile.Get1000EmXMin</a></div><div class="ttdeci">double Get1000EmXMin()</div><div class="ttdoc">Computes the maximum distance to the left of the glyph origin of the font, in thousandths of em unit.</div><div class="ttdef"><b>Definition:</b> <a href="_true_type_8cs_source.html#l02107">TrueType.cs:2107</a></div></div>
<div class="ttc" id="aclass_vect_sharp_1_1_font_html"><div class="ttname"><a href="class_vect_sharp_1_1_font.html">VectSharp.Font</a></div><div class="ttdoc">Represents a typeface with a specific size.</div><div class="ttdef"><b>Definition:</b> <a href="_graphics_8cs_source.html#l00781">Graphics.cs:782</a></div></div>
<div class="ttc" id="anamespace_vect_sharp_html_acfad2994b272989b9cb471230d95334f"><div class="ttname"><a href="namespace_vect_sharp.html#acfad2994b272989b9cb471230d95334f">VectSharp.TextBaselines</a></div><div class="ttdeci">TextBaselines</div><div class="ttdoc">Represent text baselines.</div><div class="ttdef"><b>Definition:</b> <a href="_graphics_8cs_source.html#l00041">Graphics.cs:42</a></div></div>
<div class="ttc" id="aclass_vect_sharp_1_1_raster_image_html_a5a5e8f5228b8aa3aa103693265fa900e"><div class="ttname"><a href="class_vect_sharp_1_1_raster_image.html#a5a5e8f5228b8aa3aa103693265fa900e">VectSharp.RasterImage.Interpolate</a></div><div class="ttdeci">bool Interpolate</div><div class="ttdoc">Determines whether the image should be interpolated when it is resized.</div><div class="ttdef"><b>Definition:</b> <a href="_raster_image_8cs_source.html#l00133">RasterImage.cs:133</a></div></div>
<div class="ttc" id="aclass_vect_sharp_1_1_true_type_file_html_a37a6a96e07782c4f6264a5ee11408618"><div class="ttname"><a href="class_vect_sharp_1_1_true_type_file.html#a37a6a96e07782c4f6264a5ee11408618">VectSharp.TrueTypeFile.Get1000EmXMax</a></div><div class="ttdeci">double Get1000EmXMax()</div><div class="ttdoc">Computes the maximum distance to the right of the glyph origin of the font, in thousandths of em unit...</div><div class="ttdef"><b>Definition:</b> <a href="_true_type_8cs_source.html#l02098">TrueType.cs:2098</a></div></div>
<div class="ttc" id="aclass_vect_sharp_1_1_graphics_path_html_acb6657677bfcf1f40485fa17281acee2"><div class="ttname"><a href="class_vect_sharp_1_1_graphics_path.html#acb6657677bfcf1f40485fa17281acee2">VectSharp.GraphicsPath.AddText</a></div><div class="ttdeci">GraphicsPath AddText(double originX, double originY, string text, Font font, TextBaselines textBaseline=TextBaselines.Top)</div><div class="ttdoc">Add the contour of a text string to the current path.</div><div class="ttdef"><b>Definition:</b> <a href="_graphics_8cs_source.html#l03832">Graphics.cs:3832</a></div></div>
<div class="ttc" id="anamespace_vect_sharp_html_a58a4a36ea254b3d255755654fd9e61f6"><div class="ttname"><a href="namespace_vect_sharp.html#a58a4a36ea254b3d255755654fd9e61f6">VectSharp.LineJoins</a></div><div class="ttdeci">LineJoins</div><div class="ttdoc">Represents line joining options.</div><div class="ttdef"><b>Definition:</b> <a href="_graphics_8cs_source.html#l00109">Graphics.cs:110</a></div></div>
<div class="ttc" id="aclass_vect_sharp_1_1_raster_image_html_a3012ff06029d327b3a280260fb2207f2"><div class="ttname"><a href="class_vect_sharp_1_1_raster_image.html#a3012ff06029d327b3a280260fb2207f2">VectSharp.RasterImage.HasAlpha</a></div><div class="ttdeci">bool HasAlpha</div><div class="ttdoc">Determines whether the image has an alpha channel.</div><div class="ttdef"><b>Definition:</b> <a href="_raster_image_8cs_source.html#l00118">RasterImage.cs:118</a></div></div>
<div class="ttc" id="aclass_vect_sharp_1_1_true_type_file_html_aee6f8fdf0984954c8ad83a2d9dbd91cc"><div class="ttname"><a href="class_vect_sharp_1_1_true_type_file.html#aee6f8fdf0984954c8ad83a2d9dbd91cc">VectSharp.TrueTypeFile.IsSerif</a></div><div class="ttdeci">bool IsSerif()</div><div class="ttdoc">Determines whether the typeface is serifed or not.</div><div class="ttdef"><b>Definition:</b> <a href="_true_type_8cs_source.html#l01937">TrueType.cs:1937</a></div></div>
<div class="ttc" id="aclass_vect_sharp_1_1_font_family_html"><div class="ttname"><a href="class_vect_sharp_1_1_font_family.html">VectSharp.FontFamily</a></div><div class="ttdoc">Represents a typeface.</div><div class="ttdef"><b>Definition:</b> <a href="_graphics_8cs_source.html#l00996">Graphics.cs:997</a></div></div>
<div class="ttc" id="aclass_vect_sharp_1_1_p_d_f_1_1_p_d_f_context_interpreter_html_a8cd1a292b80db0cce76c229f069899fe"><div class="ttname"><a href="class_vect_sharp_1_1_p_d_f_1_1_p_d_f_context_interpreter.html#a8cd1a292b80db0cce76c229f069899fe">VectSharp.PDF.PDFContextInterpreter.TextOptions</a></div><div class="ttdeci">TextOptions</div><div class="ttdoc">Defines whether the used fonts should be included in the file.</div><div class="ttdef"><b>Definition:</b> <a href="_p_d_f_context_8cs_source.html#l00774">PDFContext.cs:775</a></div></div>
<div class="ttc" id="aclass_vect_sharp_1_1_p_d_f_1_1_p_d_f_context_interpreter_html_aa7f62148731cd2906243f2b2ba76d8fc"><div class="ttname"><a href="class_vect_sharp_1_1_p_d_f_1_1_p_d_f_context_interpreter.html#aa7f62148731cd2906243f2b2ba76d8fc">VectSharp.PDF.PDFContextInterpreter.SaveAsPDF</a></div><div class="ttdeci">static void SaveAsPDF(this Document document, Stream stream, TextOptions textOption=TextOptions.SubsetFonts, bool compressStreams=true, Dictionary&lt; string, string &gt; linkDestinations=null)</div><div class="ttdoc">Save the document to a PDF stream.</div><div class="ttdef"><b>Definition:</b> <a href="_p_d_f_context_8cs_source.html#l00797">PDFContext.cs:797</a></div></div>
<div class="ttc" id="anamespace_vect_sharp_1_1_p_d_f_html"><div class="ttname"><a href="namespace_vect_sharp_1_1_p_d_f.html">VectSharp.PDF</a></div><div class="ttdef"><b>Definition:</b> <a href="_p_d_f_context_8cs_source.html#l00027">PDFContext.cs:28</a></div></div>
<div class="ttc" id="aclass_vect_sharp_1_1_true_type_file_html_acd1b6e15206231fc0c8a0c8a4db3d7b0"><div class="ttname"><a href="class_vect_sharp_1_1_true_type_file.html#acd1b6e15206231fc0c8a0c8a4db3d7b0">VectSharp.TrueTypeFile.Get1000EmYMin</a></div><div class="ttdeci">double Get1000EmYMin()</div><div class="ttdoc">Computes the maximum depth below the baseline of the font, in thousandths of em unit.</div><div class="ttdef"><b>Definition:</b> <a href="_true_type_8cs_source.html#l02089">TrueType.cs:2089</a></div></div>
<div class="ttc" id="anamespace_vect_sharp_html_ad82c158fff255cb1cbe8d51de61cb4e4a4803e6b9e63dabf04de980788d6a13c4"><div class="ttname"><a href="namespace_vect_sharp.html#ad82c158fff255cb1cbe8d51de61cb4e4a4803e6b9e63dabf04de980788d6a13c4">VectSharp.SegmentType.Line</a></div><div class="ttdeci">@ Line</div><div class="ttdoc">The segment represents a straight line from the current point to a new point.</div></div>
<div class="ttc" id="aclass_vect_sharp_1_1_true_type_file_html_a1e1f305a731f09899d434eab608be504"><div class="ttname"><a href="class_vect_sharp_1_1_true_type_file.html#a1e1f305a731f09899d434eab608be504">VectSharp.TrueTypeFile.Get1000EmAscent</a></div><div class="ttdeci">double Get1000EmAscent()</div><div class="ttdoc">Computes the font ascent, in thousandths of em unit.</div><div class="ttdef"><b>Definition:</b> <a href="_true_type_8cs_source.html#l02061">TrueType.cs:2061</a></div></div>
<div class="ttc" id="anamespace_vect_sharp_html_ad82c158fff255cb1cbe8d51de61cb4e4"><div class="ttname"><a href="namespace_vect_sharp.html#ad82c158fff255cb1cbe8d51de61cb4e4">VectSharp.SegmentType</a></div><div class="ttdeci">SegmentType</div><div class="ttdoc">Types of Segment.</div><div class="ttdef"><b>Definition:</b> <a href="_graphics_8cs_source.html#l01312">Graphics.cs:1313</a></div></div>
<div class="ttc" id="astruct_vect_sharp_1_1_point_html_a5ec116350a6220c1b0c5e7115fa24115"><div class="ttname"><a href="struct_vect_sharp_1_1_point.html#a5ec116350a6220c1b0c5e7115fa24115">VectSharp.Point.X</a></div><div class="ttdeci">double X</div><div class="ttdoc">Horizontal (x) coordinate, measured to the right of the origin.</div><div class="ttdef"><b>Definition:</b> <a href="_graphics_8cs_source.html#l01233">Graphics.cs:1233</a></div></div>
<div class="ttc" id="aclass_vect_sharp_1_1_raster_image_html_a7fdcc792321aae93369d85c280bf696c"><div class="ttname"><a href="class_vect_sharp_1_1_raster_image.html#a7fdcc792321aae93369d85c280bf696c">VectSharp.RasterImage.Height</a></div><div class="ttdeci">int Height</div><div class="ttdoc">The height in pixels of the image.</div><div class="ttdef"><b>Definition:</b> <a href="_raster_image_8cs_source.html#l00128">RasterImage.cs:128</a></div></div>
<div class="ttc" id="aclass_vect_sharp_1_1_p_d_f_1_1_p_d_f_context_interpreter_html"><div class="ttname"><a href="class_vect_sharp_1_1_p_d_f_1_1_p_d_f_context_interpreter.html">VectSharp.PDF.PDFContextInterpreter</a></div><div class="ttdoc">Contains methods to render a Document as a PDF document.</div><div class="ttdef"><b>Definition:</b> <a href="_p_d_f_context_8cs_source.html#l00585">PDFContext.cs:586</a></div></div>
<div class="ttc" id="aclass_vect_sharp_1_1_true_type_file_html_a78be18e6d87950d5d1bbaf1970a00564"><div class="ttname"><a href="class_vect_sharp_1_1_true_type_file.html#a78be18e6d87950d5d1bbaf1970a00564">VectSharp.TrueTypeFile.Get1000EmGlyphWidth</a></div><div class="ttdeci">double Get1000EmGlyphWidth(char glyph)</div><div class="ttdoc">Computes the advance width of a glyph, in thousandths of em unit.</div><div class="ttdef"><b>Definition:</b> <a href="_true_type_8cs_source.html#l02032">TrueType.cs:2032</a></div></div>
<div class="ttc" id="anamespace_vect_sharp_html_ad82c158fff255cb1cbe8d51de61cb4e4aced824f3a4e9dd5feb68da4cb78a3430"><div class="ttname"><a href="namespace_vect_sharp.html#ad82c158fff255cb1cbe8d51de61cb4e4aced824f3a4e9dd5feb68da4cb78a3430">VectSharp.SegmentType.CubicBezier</a></div><div class="ttdeci">@ CubicBezier</div><div class="ttdoc">The segment represents a cubic bezier curve from the current point to a new point.</div></div>
<div class="ttc" id="aclass_vect_sharp_1_1_document_html_a37c0a15de4cf1ce2ea3bc6ae074c18c9"><div class="ttname"><a href="class_vect_sharp_1_1_document.html#a37c0a15de4cf1ce2ea3bc6ae074c18c9">VectSharp.Document.Pages</a></div><div class="ttdeci">List&lt; Page &gt; Pages</div><div class="ttdoc">The pages in the document.</div><div class="ttdef"><b>Definition:</b> <a href="_document_8cs_source.html#l00032">Document.cs:32</a></div></div>
<div class="ttc" id="aclass_vect_sharp_1_1_true_type_file_html_a7fde1c54dbe0648291951d248aebee18"><div class="ttname"><a href="class_vect_sharp_1_1_true_type_file.html#a7fde1c54dbe0648291951d248aebee18">VectSharp.TrueTypeFile.IsScript</a></div><div class="ttdeci">bool IsScript()</div><div class="ttdoc">Determines whether the typeface is a script typeface or not.</div><div class="ttdef"><b>Definition:</b> <a href="_true_type_8cs_source.html#l01948">TrueType.cs:1948</a></div></div>
<div class="ttc" id="aclass_vect_sharp_1_1_true_type_file_html_a8df9028202564d2a8ca841102e558a1f"><div class="ttname"><a href="class_vect_sharp_1_1_true_type_file.html#a8df9028202564d2a8ca841102e558a1f">VectSharp.TrueTypeFile.FontStream</a></div><div class="ttdeci">Stream FontStream</div><div class="ttdoc">A stream pointing to the TrueType file source (either on disk or in memory). Never dispose this strea...</div><div class="ttdef"><b>Definition:</b> <a href="_true_type_8cs_source.html#l00046">TrueType.cs:46</a></div></div>
<div class="ttc" id="aclass_vect_sharp_1_1_font_family_html_a6cdec4eb0a660064bc416e81f69d3780"><div class="ttname"><a href="class_vect_sharp_1_1_font_family.html#a6cdec4eb0a660064bc416e81f69d3780">VectSharp.FontFamily.StandardFontFamilies</a></div><div class="ttdeci">StandardFontFamilies</div><div class="ttdoc">The 14 standard font families.</div><div class="ttdef"><b>Definition:</b> <a href="_graphics_8cs_source.html#l01035">Graphics.cs:1036</a></div></div>
<div class="ttc" id="aclass_vect_sharp_1_1_true_type_file_html_a282ffb486dc20d30f55f64941ab32720"><div class="ttname"><a href="class_vect_sharp_1_1_true_type_file.html#a282ffb486dc20d30f55f64941ab32720">VectSharp.TrueTypeFile.GetFontName</a></div><div class="ttdeci">string GetFontName()</div><div class="ttdoc">Obtains the PostScript font name from the TrueType file.</div><div class="ttdef"><b>Definition:</b> <a href="_true_type_8cs_source.html#l01851">TrueType.cs:1851</a></div></div>
<div class="ttc" id="astruct_vect_sharp_1_1_line_dash_html"><div class="ttname"><a href="struct_vect_sharp_1_1_line_dash.html">VectSharp.LineDash</a></div><div class="ttdoc">Represents instructions on how to paint a dashed line.</div><div class="ttdef"><b>Definition:</b> <a href="_graphics_8cs_source.html#l00130">Graphics.cs:131</a></div></div>
<div class="ttc" id="ainterface_vect_sharp_1_1_i_graphics_context_html"><div class="ttname"><a href="interface_vect_sharp_1_1_i_graphics_context.html">VectSharp.IGraphicsContext</a></div><div class="ttdoc">This interface should be implemented by classes intended to provide graphics output capability to a G...</div><div class="ttdef"><b>Definition:</b> <a href="_graphics_8cs_source.html#l02081">Graphics.cs:2082</a></div></div>
<div class="ttc" id="aclass_vect_sharp_1_1_raster_image_html_aaa0c2c00b3f570797d0eb31ea899dae2"><div class="ttname"><a href="class_vect_sharp_1_1_raster_image.html#aaa0c2c00b3f570797d0eb31ea899dae2">VectSharp.RasterImage.ImageDataAddress</a></div><div class="ttdeci">IntPtr ImageDataAddress</div><div class="ttdoc">The memory address of the image pixel data.</div><div class="ttdef"><b>Definition:</b> <a href="_raster_image_8cs_source.html#l00103">RasterImage.cs:103</a></div></div>
<div class="ttc" id="anamespace_vect_sharp_html_ad82c158fff255cb1cbe8d51de61cb4e4a2b73f91683611c489560a1d163e37902"><div class="ttname"><a href="namespace_vect_sharp.html#ad82c158fff255cb1cbe8d51de61cb4e4a2b73f91683611c489560a1d163e37902">VectSharp.SegmentType.Arc</a></div><div class="ttdeci">@ Arc</div><div class="ttdoc">The segment represents a circular arc from the current point to a new point.</div></div>
<div class="ttc" id="astruct_vect_sharp_1_1_point_html"><div class="ttname"><a href="struct_vect_sharp_1_1_point.html">VectSharp.Point</a></div><div class="ttdoc">Represents a point relative to an origin in the top-left corner.</div><div class="ttdef"><b>Definition:</b> <a href="_graphics_8cs_source.html#l01228">Graphics.cs:1229</a></div></div>
<div class="ttc" id="aclass_vect_sharp_1_1_true_type_file_html_a7e8376d45118eef1099fe0ad33d0e21b"><div class="ttname"><a href="class_vect_sharp_1_1_true_type_file.html#a7e8376d45118eef1099fe0ad33d0e21b">VectSharp.TrueTypeFile.IsBold</a></div><div class="ttdeci">bool IsBold()</div><div class="ttdoc">Determines whether the typeface is Bold or not.</div><div class="ttdef"><b>Definition:</b> <a href="_true_type_8cs_source.html#l01915">TrueType.cs:1915</a></div></div>
<div class="ttc" id="aclass_vect_sharp_1_1_true_type_file_html_acd6fac0c1556a58be91ddfcda2f40963"><div class="ttname"><a href="class_vect_sharp_1_1_true_type_file.html#acd6fac0c1556a58be91ddfcda2f40963">VectSharp.TrueTypeFile.Get1000EmDescent</a></div><div class="ttdeci">double Get1000EmDescent()</div><div class="ttdoc">Computes the font descent, in thousandths of em unit.</div><div class="ttdef"><b>Definition:</b> <a href="_true_type_8cs_source.html#l02071">TrueType.cs:2071</a></div></div>
<div class="ttc" id="astruct_vect_sharp_1_1_colour_html_a80787f39829f01b38291bb429214d6ae"><div class="ttname"><a href="struct_vect_sharp_1_1_colour.html#a80787f39829f01b38291bb429214d6ae">VectSharp.Colour.FromRgb</a></div><div class="ttdeci">static Colour FromRgb(double r, double g, double b)</div><div class="ttdoc">Create a new colour from RGB (red, green and blue) values.</div><div class="ttdef"><b>Definition:</b> <a href="_graphics_8cs_source.html#l00206">Graphics.cs:206</a></div></div>
<div class="ttc" id="aclass_vect_sharp_1_1_p_d_f_1_1_p_d_f_context_interpreter_html_ac369a9c6df21b7e929fc91cea604c05e"><div class="ttname"><a href="class_vect_sharp_1_1_p_d_f_1_1_p_d_f_context_interpreter.html#ac369a9c6df21b7e929fc91cea604c05e">VectSharp.PDF.PDFContextInterpreter.SaveAsPDF</a></div><div class="ttdeci">static void SaveAsPDF(this Document document, string fileName, TextOptions textOption=TextOptions.SubsetFonts, bool compressStreams=true, Dictionary&lt; string, string &gt; linkDestinations=null)</div><div class="ttdoc">Save the document to a PDF file.</div><div class="ttdef"><b>Definition:</b> <a href="_p_d_f_context_8cs_source.html#l00763">PDFContext.cs:763</a></div></div>
<div class="ttc" id="aclass_vect_sharp_1_1_true_type_file_html_abd9c8b6a0adca6684e4bc629a447d849"><div class="ttname"><a href="class_vect_sharp_1_1_true_type_file.html#abd9c8b6a0adca6684e4bc629a447d849">VectSharp.TrueTypeFile.GetFontFamilyName</a></div><div class="ttdeci">string GetFontFamilyName()</div><div class="ttdoc">Obtains the font family name from the TrueType file.</div><div class="ttdef"><b>Definition:</b> <a href="_true_type_8cs_source.html#l01823">TrueType.cs:1823</a></div></div>
<div class="ttc" id="anamespace_vect_sharp_html_ad82c158fff255cb1cbe8d51de61cb4e4a6bc362dbf494c61ea117fe3c71ca48a5"><div class="ttname"><a href="namespace_vect_sharp.html#ad82c158fff255cb1cbe8d51de61cb4e4a6bc362dbf494c61ea117fe3c71ca48a5">VectSharp.SegmentType.Move</a></div><div class="ttdeci">@ Move</div><div class="ttdoc">The segment represents a move from the current point to a new point.</div></div>
<div class="ttc" id="astruct_vect_sharp_1_1_point_html_ae56e39cc16440deee22e54e89024f044"><div class="ttname"><a href="struct_vect_sharp_1_1_point.html#ae56e39cc16440deee22e54e89024f044">VectSharp.Point.Y</a></div><div class="ttdeci">double Y</div><div class="ttdoc">Vertical (y) coordinate, measured to the bottom of the origin.</div><div class="ttdef"><b>Definition:</b> <a href="_graphics_8cs_source.html#l01238">Graphics.cs:1238</a></div></div>
<div class="ttc" id="aclass_vect_sharp_1_1_graphics_path_html_aabd97b02c49fc2de576d76710af8fedc"><div class="ttname"><a href="class_vect_sharp_1_1_graphics_path.html#aabd97b02c49fc2de576d76710af8fedc">VectSharp.GraphicsPath.Segments</a></div><div class="ttdeci">List&lt; Segment &gt; Segments</div><div class="ttdoc">The segments that make up the path.</div><div class="ttdef"><b>Definition:</b> <a href="_graphics_8cs_source.html#l03588">Graphics.cs:3588</a></div></div>
<div class="ttc" id="astruct_vect_sharp_1_1_colour_html_ae8dc3a457be395b0350db3508424a324"><div class="ttname"><a href="struct_vect_sharp_1_1_colour.html#ae8dc3a457be395b0350db3508424a324">VectSharp.Colour.FromRgba</a></div><div class="ttdeci">static Colour FromRgba(double r, double g, double b, double a)</div><div class="ttdoc">Create a new colour from RGBA (red, green, blue and alpha) values.</div><div class="ttdef"><b>Definition:</b> <a href="_graphics_8cs_source.html#l00243">Graphics.cs:243</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_c0a49aad9c77eb50f1b38df9d9b26fde.html">VectSharp.PDF</a></li><li class="navelem"><b>PDFContext.cs</b></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.18 </li>
  </ul>
</div>
</body>
</html>
